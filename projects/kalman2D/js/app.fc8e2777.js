(function(t){function e(e){for(var i,r,l=e[0],o=e[1],u=e[2],c=0,d=[];c<l.length;c++)r=l[c],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);h&&h(e);while(d.length)d.shift()();return n.push.apply(n,u||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,l=1;l<a.length;l++){var o=a[l];0!==s[o]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},s={app:0},n=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/kalman/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var h=o;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var i=a("64a9"),s=a.n(i);s.a},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("Kalman")],1)},n=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",{staticClass:"title"},[t._v("Kalman Filter 2D | 卡尔曼滤波器 2D")]),a("h3",{staticClass:"subtitle"},[t._v("By Frank Luo")]),a("mu-row",{staticClass:"stats",attrs:{gutter:""}},[a("mu-col",{staticStyle:{"font-size":"16px"},attrs:{sm:"0",md:"1",lg:"2",span:"12"}}),a("mu-col",{staticStyle:{"font-size":"18px"},attrs:{sm:"12",md:"10",lg:"8",span:"12"}},[a("center",[t._v("\n\t\t\t\t移植"),a("a",{attrs:{href:"https://github.com/longluo/Publish/blob/master/Kalman/"}},[t._v("OpenCV")]),t._v("版本为"),a("b",[t._v("Web")]),t._v("版本，鼠标悬停在画布上以绘制路径(Hover\n\t\t\t\tthe mouse on the canvas to draw the path yourself)。\n\t\t\t\t"),a("br"),a("br"),t._v("\n\t\t\t\t蓝色是真实路径(Blue is real path)，绿色是加上噪声之后路径(Green is adding noise to the real path)，白色是预测路径(White\n\t\t\t\tis the\n\t\t\t\tprediction path)，粉色是卡尔曼滤波之后路径("),a("b",[t._v("Pink")]),t._v(" is the Kalman Filtered path)。\n\t\t\t\t"),a("br"),a("br"),t._v("\n\t\t\t\tExplore "),a("a",{attrs:{href:"http://www.longluo.me/projects/kalman/"}},[t._v("1D Kalman Filter")]),t._v(", Read more about "),a("a",{attrs:{href:"http://www.longluo.me/blog/2023/04/29/Kalman-Filter/"}},[t._v("Kalman Filter")]),t._v(".\n\t\t\t")])],1),a("mu-col",{staticStyle:{"font-size":"16px"},attrs:{sm:"0",md:"1",lg:"2",span:"12"}})],1),a("br"),a("br"),a("mu-row",{staticClass:"stats",attrs:{gutter:""}},[a("mu-col",{staticStyle:{"padding-left":"5%","padding-right":"2.5%",padding:"15px"},attrs:{sm:"12",md:"12",lg:"4",span:"12"}},[a("div",{staticClass:"grid-cell"},[a("mu-button",{attrs:{color:t.startBtnColor},on:{click:t.handleStartButton}},[t._v("\n\t\t\t\t\t"+t._s(t.startBtnText)+"\n\t\t\t\t")]),t._v(" \n\n\t\t\t\t"),a("mu-button",{attrs:{color:"red"},on:{click:t.init}},[t._v("\n\t\t\t\t\tReset\n\t\t\t\t")]),a("br"),a("br"),t._v("\n\n\t\t\t\tFrame Rate: "),a("b",[t._v(t._s(t.framerate))]),t._v(" FPS\n\t\t\t\t"),a("mu-slider",{staticClass:"slider",attrs:{type:"range",min:0,max:80,step:1,value:"50"},model:{value:t.framerate,callback:function(e){t.framerate=e},expression:"framerate"}}),t._v("\n\n\t\t\t\tTTL: "),a("b",[t._v(t._s(t.ttl)+" ")]),t._v(" frames\n\t\t\t\t"),a("mu-slider",{staticClass:"slider",attrs:{type:"range",min:0,max:200,step:1,value:"50"},model:{value:t.ttl,callback:function(e){t.ttl=e},expression:"ttl"}}),t._v("\n\n\t\t\t\tNoise covariance σ: "),a("b",[t._v(t._s(t.sigma))]),a("mu-slider",{staticClass:"demo-slider",attrs:{min:0,max:t.width/3,step:1},model:{value:t.sigma,callback:function(e){t.sigma=e},expression:"sigma"}}),t._v("\n\n\t\t\t\tPrediction Steps : "),a("b",[t._v(t._s(t.predSteps))]),a("mu-slider",{staticClass:"demo-slider",attrs:{min:1,max:50,step:1},model:{value:t.predSteps,callback:function(e){t.predSteps=e},expression:"predSteps"}}),t._v("\n\n\t\t\t\tShow:"),a("br"),a("mu-checkbox",{attrs:{label:"Real Path"},model:{value:t.drawReal,callback:function(e){t.drawReal=e},expression:"drawReal"}}),a("mu-checkbox",{attrs:{label:"Noisy"},model:{value:t.drawNoisy,callback:function(e){t.drawNoisy=e},expression:"drawNoisy"}}),a("mu-checkbox",{attrs:{label:"Noisy Path"},model:{value:t.drawNoisyTraj,callback:function(e){t.drawNoisyTraj=e},expression:"drawNoisyTraj"}}),a("br"),a("mu-checkbox",{attrs:{label:"Filtered"},model:{value:t.drawFiltered,callback:function(e){t.drawFiltered=e},expression:"drawFiltered"}}),a("mu-checkbox",{attrs:{label:"Filtered Path"},model:{value:t.drawFilteredTraj,callback:function(e){t.drawFilteredTraj=e},expression:"drawFilteredTraj"}}),a("mu-checkbox",{attrs:{label:"Prediction"},model:{value:t.prediction,callback:function(e){t.prediction=e},expression:"prediction"}}),a("br"),a("br"),t._v("\n\n\t\t\t\tCanvas"),a("br"),t._v("\n\n\t\t\t\tWidth: "+t._s(t.width)+"px"),a("br"),t.showCanvasControls?a("mu-slider",{staticClass:"slider",attrs:{type:"range",min:0,max:1800,step:1,value:"75"},model:{value:t.widthC,callback:function(e){t.widthC=e},expression:"widthC"}}):t._e(),t._v("\n\n\t\t\t\tHeight: "+t._s(t.height)+"px"),a("br"),t.showCanvasControls?a("mu-slider",{staticClass:"slider",attrs:{type:"range",min:0,max:1e3,step:1,value:"75"},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}}):t._e(),a("br"),t._v("\n\n\t\t\t\tstatus: "),a("code",[t._v(t._s(t.status))]),a("br"),a("code",[t._v(t._s(t.states.length))]),t._v(" states drawn."),a("br"),a("code",[t._v(t._s(Math.round(t.ms)))]),t._v(" ms per frame\n\t\t\t")],1)]),a("mu-col",{attrs:{sm:"12",md:"12",lg:"8",span:"12"}},[a("div",{staticClass:"grid-cell"},[a("canvas",{ref:"ccont",staticClass:"kalmandemo",attrs:{width:t.widthC,height:t.heightC},on:{mouseleave:t.mouseLeave,pointermove:t.mouseOver}})])])],1),t._m(0)],1)},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("small",{staticStyle:{"font-size":"1rem"}},[a("p",[t._v("\n\t\t\tCopyright © 2022 - 2023 "),a("a",{attrs:{href:"http://longluo.me"}},[t._v(" Long Luo. ")]),t._v("\n\t\t\tAll Rights Reserved.\n\t\t")])])}],o=(a("6c7b"),a("6b54"),a("d225")),u=a("b0b4"),h=a("bd86");(function(){function t(t,e){return isNaN(t)?e:t}Math.randomGaussian=function(e,a){if(e=t(e,0),a=t(a,1),void 0!==Math.randomGaussian.nextGaussian){var i=Math.randomGaussian.nextGaussian;return delete Math.randomGaussian.nextGaussian,i*a+e}var s,n,r,l;do{s=2*Math.random()-1,n=2*Math.random()-1,r=s*s+n*n}while(r>=1||0==r);return l=Math.sqrt(-2*Math.log(r)/r),Math.randomGaussian.nextGaussian=n*l,s*l*a+e},Math.getGaussianFunction=function(e,a,i){return e=t(e,0),a=t(a,1),i=t(i,1),function(t){return i*Math.pow(Math.E,-Math.pow(t-e,2)/(a*a*2))}}})();var c={data:function(){var t;return t={width:350,height:350,heightC:700,widthC:700,ctx:null,lastCalledTime:null,fps:0,framecount:0,status:"paused",states:[],framerate:60,lastPoint:null,A:null,B:null,H:null,Q:null,R:null},Object(h["a"])(t,"B",null),Object(h["a"])(t,"c",null),Object(h["a"])(t,"last",null),Object(h["a"])(t,"ms",0),Object(h["a"])(t,"realPoint",null),Object(h["a"])(t,"sigma",15),Object(h["a"])(t,"startBtnText","Start"),Object(h["a"])(t,"startBtnColor","blue"),Object(h["a"])(t,"traj",!1),Object(h["a"])(t,"drawReal",!0),Object(h["a"])(t,"drawNoisy",!1),Object(h["a"])(t,"drawNoisyTraj",!0),Object(h["a"])(t,"drawFiltered",!1),Object(h["a"])(t,"drawFilteredTraj",!0),Object(h["a"])(t,"drawPrediction",!0),Object(h["a"])(t,"prediction",!1),Object(h["a"])(t,"predSteps",15),Object(h["a"])(t,"ttl",50),Object(h["a"])(t,"oldmov",null),Object(h["a"])(t,"oldoldmov",null),Object(h["a"])(t,"cscale",1),Object(h["a"])(t,"showCanvasControls",!1),t},mounted:function(){var t=this.$refs.ccont;this.ctx=t.getContext("2d",{alpha:!1}),this.ctx.scale(2,2),this.handleStartButton()},methods:{handleStartButton:function(){this.init(),this.frame(),this.showCanvasControls=!1,"paused"==this.status?(this.status="running",this.startBtnText="Pause"):(this.status="paused",this.startBtnText="Start")},getRandomInt:function(t){return Math.floor(Math.random()*Math.floor(t))},mouseLeave:function(){},mouseOver:function(t){var e=this.$refs.ccont,a=e.getBoundingClientRect();this.clientX=t.clientX-a.left,this.clientY=t.clientY-a.top},init:function(){this.states=[],this.realPoint=null;var t=window.$M,e=window.$V;this.c=e([0,0,0,0]),this.A=t([[1,0,.2,0],[0,1,0,.2],[0,0,1,0],[0,0,0,1]]),this.B=t([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]),this.H=t([[1,0,1,0],[0,1,0,1],[0,0,0,0],[0,0,0,0]]),this.Q=t([[0,0,0,0],[0,0,0,0],[0,0,.1,0],[0,0,0,.1]]),this.R=t([[this.sigma,0,0,0],[0,this.sigma,0,0],[0,0,this.sigma,0],[0,0,0,this.sigma]]),this.lastPoint=e([0,0,0,0]),this.last=t([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),this.height=this.heightC/2,this.width=this.widthC/2,this.ctx.fillStyle="#37474f",this.ctx.fillRect(0,0,this.width,this.height),this.State=function(){function t(e,a,i){Object(o["a"])(this,t),this.realInput=e,this.noisyInput=a,this.kalmanPoint=i,this.dead=!1}return Object(u["a"])(t,[{key:"get",value:function(){return[this.noisyInput.x,this.noisyInput.y,this.noisyInput.ttl]}},{key:"getK",value:function(){return[this.kalmanPoint.x,this.kalmanPoint.y]}},{key:"displayReal",value:function(){this.realInput.display("#000080")}},{key:"displayFiltered",value:function(){this.kalmanPoint.display("#FF0000")}},{key:"displayNoisy",value:function(){this.noisyInput.display("#008B45")}},{key:"displayPrediction",value:function(){this.noisyInput.display("#F8F8FF")}},{key:"update",value:function(){this.realInput.update(),this.noisyInput.update(),this.kalmanPoint.update(),0==this.realInput.ttl&&(this.dead=!0)}}]),t}();var a=this;this.Point=function(){function t(e,i,s){Object(o["a"])(this,t),this.x=e,this.y=i,this.ttl=a.ttl,this.ctx=s}return Object(u["a"])(t,[{key:"display",value:function(t){var e=Math.round(255*this.ttl/a.ttl).toString(16);this.ctx.beginPath(),this.ctx.arc(this.x,this.y,1.25,0,2*Math.PI),this.ctx.fillStyle=t+e,this.ctx.fill()}},{key:"update",value:function(){this.ttl--}}]),t}()},frame:function(){var t=performance.now();if("running"==this.status){var e=window.$V,a=this.ctx;this.ctx.fillStyle="#1f1f31",this.ctx.fillRect(0,0,this.width,this.height);this.realPoint=new this.Point(this.clientX/2,this.clientY/2,a);var i=Math.round(this.realPoint.x+Math.randomGaussian(0,this.sigma)),s=Math.round(this.realPoint.y+Math.randomGaussian(0,this.sigma)),n=new this.Point(i,s,a),r=i-this.lastPoint.elements[0],l=s-this.lastPoint.elements[1],o=e([i,s,r,l]),u=this.A.multiply(this.lastPoint).add(this.B.multiply(this.c)),h=this.A.multiply(this.last).multiply(this.A.transpose()).add(this.Q),c=this.H.multiply(h).multiply(this.H.transpose()).add(this.R),d=h.multiply(this.H.transpose()).multiply(c.inverse()),p=o.subtract(this.H.multiply(u));this.lastPoint=u.add(d.multiply(p)),this.last=window.Matrix.I(4).subtract(d.multiply(this.H)).multiply(h);var m=new this.Point(this.lastPoint.elements[0],this.lastPoint.elements[1],a);if(this.prediction)for(var f=this.lastPoint,v=this.predSteps,b=Array(),y=0;y<v;y++){f=this.A.multiply(f).add(this.B.multiply(this.c));var g=f.elements[0],w=f.elements[1];b.push(new this.Point(g,w,a))}this.states.push(new this.State(this.realPoint,n,m));for(var x=this.states.length-1;x>0;--x){var _=this.states[x];if(this.drawReal&&_.displayReal(),this.drawNoisy&&_.displayNoisy(),this.drawFiltered&&_.displayFiltered(),_.update(),x>1){var j=_.get(),P=Math.round(255*j[2]/this.ttl).toString(16);if(this.drawNoisyTraj){var k=this.states[x-1].get();a.strokeStyle="#00CD66"+P,a.lineWidth=1,a.beginPath(),a.moveTo(j[0],j[1]),a.lineTo(k[0],k[1]),a.stroke()}if(this.drawFilteredTraj){j=_.getK(),k=this.states[x-1].getK();a.strokeStyle="#FF1493"+P,a.lineWidth=2,a.beginPath(),a.moveTo(j[0],j[1]),a.lineTo(k[0],k[1]),a.stroke()}}_.dead&&this.states.splice(x,1)}if(this.prediction)for(y=0;y<b.length;y++)b[y].display("#F8F8FF")}this.lastCalledTime=performance.now();var O=performance.now()-t;this.ms=O,setTimeout(this.frame,1e3/this.framerate-O)}}},d=c,p=(a("df31"),a("2877")),m=Object(p["a"])(d,r,l,!1,null,"6196f76c",null),f=m.exports,v={name:"app",components:{Kalman:f}},b=v,y=(a("034f"),Object(p["a"])(b,s,n,!1,null,null,null)),g=y.exports,w=a("30f4");a("d6f6");i["a"].use(w["a"]),i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(g)}}).$mount("#app")},"64a9":function(t,e,a){},"6d56":function(t,e,a){},df31:function(t,e,a){"use strict";var i=a("6d56"),s=a.n(i);s.a}});
//# sourceMappingURL=app.fc8e2777.js.map