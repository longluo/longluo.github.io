<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta content=#222 name=theme-color><meta content="Hexo 7.1.1" name=generator><link href=https://fonts.googleapis.com rel=preconnect><link href=https://unpkg.com rel=preconnect><link href=https://www.longluo.me/assets/logo/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://www.longluo.me/assets/logo/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://www.longluo.me/assets/logo/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=n6mekvZa-QaR3EnDD-CzJymq7mGubpU7rvoGpKROHLE name=google-site-verification><meta content=6BFBD4DDDB3B6F4FDD26CF82BADDB931 name=msvalidate.01><meta content=a2ab49d952ea45f5 name=yandex-verification><meta content=www.longluo.me name=baidu-site-verification><link href=/css/main.css rel=stylesheet><link as=style href=https://fonts.googleapis.com/css2?family=Noto+Serif+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Roboto+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext onload=this.rel='stylesheet' rel=preload><link as=style href=https://unpkg.com/@fortawesome/fontawesome-free@7.0.0/css/all.min.css onload=this.rel='stylesheet' rel=preload><link crossorigin=anonymous href=https://unpkg.com/animate.css@3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"www.longluo.me","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.24.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"language":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":5,"unescape":false,"preload":false}}</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/config.js></script><meta content="By Long Luo 之前写过一篇介绍 CORDIC 算法 1 的文章，里面提到 CORDIC 算法的 不足 之处，CORDIC 算法的输入角度范围需要在 \([−99.88^{\circ} , 99.88^{\circ}]\) ，那么我们不禁要问，如果输入角度 \(\large {\theta }\) 很大的话，怎么处理呢？ 这个问题同样存在于 泰勒展开式(Taylor series) 2 中" name=description><meta content=article property=og:type><meta content="参数归约算法(Argument Range Reduction)：如何在浮点数环境下计算超大数字的三角函数值？" property=og:title><meta content=https://www.longluo.me/blog/argument-range-reduction/index.html property=og:url><meta content="Long Luo's Life Notes" property=og:site_name><meta content="By Long Luo 之前写过一篇介绍 CORDIC 算法 1 的文章，里面提到 CORDIC 算法的 不足 之处，CORDIC 算法的输入角度范围需要在 \([−99.88^{\circ} , 99.88^{\circ}]\) ，那么我们不禁要问，如果输入角度 \(\large {\theta }\) 很大的话，怎么处理呢？ 这个问题同样存在于 泰勒展开式(Taylor series) 2 中" property=og:description><meta content=zh_CN property=og:locale><meta content=2023-09-16T14:05:07.000Z property=article:published_time><meta content=2025-05-08T13:41:25.714Z property=article:modified_time><meta content="Long Luo" property=article:author><meta content=Math property=article:tag><meta content=Algorithm property=article:tag><meta content=Arithmetic property=article:tag><meta content="Argument Reduction" property=article:tag><meta content="Computer Arithmetic" property=article:tag><meta content=Trigonometric property=article:tag><meta content="Floating point" property=article:tag><meta content=summary name=twitter:card><link href=https://www.longluo.me/blog/argument-range-reduction/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.longluo.me/blog/argument-range-reduction/","path":"/blog/argument-range-reduction/","title":"参数归约算法(Argument Range Reduction)：如何在浮点数环境下计算超大数字的三角函数值？"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>参数归约算法(Argument Range Reduction)：如何在浮点数环境下计算超大数字的三角函数值？ | Long Luo's Life Notes</title><script async src=https://www.googletagmanager.com/gtag/js?id=UA-46213499-2></script><script class=next-config data-name=google_analytics type=application/json>{"tracking_id":"UA-46213499-2","only_pageview":false,"measure_protocol_api_secret":null}</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/analytics/google-analytics.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?a75fb5d0c0ef1e36c34b7f52bb7c48be></script><script async src=https://assets.growingio.com/2.1/gio.js></script><script class=next-config data-name=growingio_analytics type=application/json>"bc65befc551b6d70"</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/analytics/growingio.js></script><script>(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "gz2vdkhgvh");</script><script data-domain=longluo.me defer src=https://plausible.io/js/script.js></script><script crossorigin=anonymous defer integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://unpkg.com/animejs@3.2.1/lib/anime.min.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/utils.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/motion.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/sidebar.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/next-boot.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/bookmark.js></script><script crossorigin=anonymous defer integrity=sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg= src=https://unpkg.com/hexo-generator-searchdb@1.5.0/dist/search.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/search/local-search.js></script><script async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script class=next-config data-name=enableMath type=application/json>true</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"ams","js":{"url":"https://unpkg.com/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/math/mathjax.js></script><link href=https://waline.longluo.me/ rel=dns-prefetch><noscript><link href=/css/noscript.css rel=stylesheet></noscript><style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style><link title="Long Luo's Life Notes" href=/atom.xml rel=alternate type=application/atom+xml><link title="Long Luo's Life Notes" href=/rss2.xml rel=alternate type=application/rss+xml><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>Long Luo's Life Notes</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>每一天都是奇迹</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-works"><a href=/works rel=section><i class="fa fa-code fa-fw"></i>作品</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-links"><a href=/links/ rel=section><i class="fa fa-link fa-fw"></i>友链</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BB%8E%E5%B0%8F%E5%AD%A6%E8%AE%A1%E7%AE%97%E9%A2%98%E5%BC%80%E5%A7%8B><span class=nav-number>1.</span> <span class=nav-text>从小学计算题开始</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%82%E6%95%B0%E5%BD%92%E7%BA%A6-argument-reduction><span class=nav-number>2.</span> <span class=nav-text>什么是参数归约 Argument Reduction ？</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%A6%82%E4%BD%95%E5%AF%B9%E5%8F%82%E6%95%B0%E8%BF%9B%E8%A1%8C%E5%BD%92%E7%BA%A6><span class=nav-number>3.</span> <span class=nav-text>如何对参数进行归约？</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-numerical-analysis><span class=nav-number>4.</span> <span class=nav-text>数值分析 Numerical Analysis</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#cody-waite-%E5%BD%92%E7%BA%A6%E7%AE%97%E6%B3%95><span class=nav-number>5.</span> <span class=nav-text>Cody-Waite 归约算法</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#payne-hanek-%E5%BD%92%E7%BA%A6%E7%AE%97%E6%B3%95><span class=nav-number>6.</span> <span class=nav-text>Payne-Hanek 归约算法</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%AE%A1%E7%AE%97-large-k><span class=nav-number>7.</span> <span class=nav-text>计算 \(\large {k}\)</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%B0%8F%E7%BB%93><span class=nav-number>8.</span> <span class=nav-text>小结</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE><span class=nav-number>9.</span> <span class=nav-text>参考文献</span></a></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt="Long Luo" class=site-author-image itemprop=image src=https://www.longluo.me/assets/avatar/sinc-3d-python.png><p class=site-author-name itemprop=name>Long Luo<div class=site-description itemprop=description>A Curious Engineer</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>349</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>28</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>429</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/longluo" href=https://github.com/longluo target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="ZhiHu → http://www.zhihu.com/people/longluo" href=http://www.zhihu.com/people/longluo target=_blank><i class="fab fa-quora fa-fw"></i>ZhiHu</a> </span><span class=links-of-author-item> <a rel="noopener me" title="LinkedIn → https://www.linkedin.com/in/longluo/" href=https://www.linkedin.com/in/longluo/ target=_blank><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a> </span><span class=links-of-author-item> <a rel="noopener me" title="E-Mail → mailto:luolong0226@163.com" href=mailto:luolong0226@163.com target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><img alt="Creative Commons" src=https://unpkg.com/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div><div class="sidebar-inner sidebar-blogroll"><div class="links-of-blogroll animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i> 链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://blog.csdn.net/tcpipstack rel=noopener target=_blank title=http://blog.csdn.net/tcpipstack>My CSDN</a></ul></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://www.longluo.me/blog/argument-range-reduction/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc-3d-python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="参数归约算法(Argument Range Reduction)：如何在浮点数环境下计算超大数字的三角函数值？ | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>参数归约算法(Argument Range Reduction)：如何在浮点数环境下计算超大数字的三角函数值？<a class=post-edit-link href=https://github.com/longluo/blog/tree/master/source/_posts/argument-range-reduction.md rel=noopener target=_blank title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2023-09-16 22:05:07" datetime=2023-09-16T22:05:07+08:00>2023-09-16</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-05-08 21:41:25" datetime=2025-05-08T21:41:25+08:00 itemprop=dateModified>2025-05-08</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Math/ itemprop=url rel=index><span itemprop=name>Math</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/argument-range-reduction/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/argument-range-reduction/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/argument-range-reduction/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>5.7k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>5 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p>之前写过一篇介绍 CORDIC 算法 <a class=footnote-ref href=#fn1 id=fnref1 role=doc-noteref><sup>1</sup></a> 的文章，里面提到 CORDIC 算法的 <a href=https://www.longluo.me/blog/cordic/#cordic-%E7%AE%97%E6%B3%95%E7%9A%84%E4%B8%8D%E8%B6%B3><strong>不足</strong></a> 之处，CORDIC 算法的输入角度范围需要在 <span class="math inline">\([−99.88^{\circ} , 99.88^{\circ}]\)</span> ，那么我们不禁要问，如果输入角度 <span class="math inline">\(\large {\theta }\)</span> 很大的话，怎么处理呢？<p>这个问题同样存在于 泰勒展开式(Taylor series) <a class=footnote-ref href=#fn2 id=fnref2 role=doc-noteref><sup>2</sup></a> 中，比如 <span class="math inline">\(\large {\sin (x) }\)</span> 和 <span class="math inline">\(\large {\cos (x) }\)</span> 的泰勒展开式：<p><span class="math display">\[ \sin(x) = x - \frac {1}{3!}x^3 + \frac {1}{5!}x^5 - \frac {1}{7!} x^7 + \frac {1}{9!} x^9 + o(x^9) \quad \forall x \subset \mathbb{R} \]</span><p><span class="math display">\[ \cos(x) = 1 - \frac {1}{2!}x^2 + \frac {1}{4!}x^4 - \frac {1}{6!} x^6 + \frac {1}{8!} x^8 + o(x^8) \quad \forall x \subset \mathbb{R} \]</span><p>虽然在整个实数集 <span class="math inline">\(\large { \mathbb{R}}\)</span> 都成立，但是在实际应用中因为展开项数限制和浮点数的精度限制， <span class="math inline">\(\large {x}\)</span> 的范围只有在接近 <span class="math inline">\(\large {0}\)</span> 的时候才有比较高的精度。<p>但是实际应用中，如果输入 <span class="math inline">\(\large {x}\)</span> 很大的话，比如 <span class="math inline">\(\large {2^{32}, 10^{10}, 10^{22} \dots }\)</span> 情况下怎么得到足够精确的值呢？<p>中学里我们知道三角函数是<strong>周期函数</strong>，对于比较大的值，我们可以使用下面的公式将值<strong>归约</strong>到一个比较小的范围内。<p><span class="math display">\[ x' = x - 2k \pi \quad k \subset \mathbb{Z} \]</span><p>这就是我们今天要讲的 <strong>参数归约(Argument Reduction)</strong> 算法。<h2 id=从小学计算题开始>从小学计算题开始</h2><p><strong>参数归约</strong> 听起来就很唬人，什么是参数啊，什么归约啊，都是些高大上的名词，听起来云里雾里的！<p>为了不让大家产生厌倦和畏难心理，我们先从一道小学数学计算题开始：<p>不借助计算器，计算 <span class="math inline">\(\large {66600 \times 666000}\)</span> 的值！<p>对于这道题，大家可能会列出下列算术：<p><span class="math display">\[ 66600 \times 666000 = 666 \times 666 \times 100000 = 44355600000 \]</span><p>但其实呢，我们也可以使用下面的方法：<p><span class="math display">\[ \begin{aligned} 66600 \times 666000 &= 111^2 \times 4 \times 9 \times 10^5 \\&= 444 \times 999 \times 10^5 \\&= 444 \times (1000 - 1) \times 10^5 \\&= 4443556 \times 10^5 \end{aligned} \]</span><p>如果我说上面这 <span class="math inline">\(\large {2}\)</span> 种方法都用到了<strong>参数归约</strong>的思想，你可能会感到震惊，什么？这种小学计算题也用到了参数归约算法吗？</p><span id=more></span><h2 id=什么是参数归约-argument-reduction>什么是参数归约 Argument Reduction ？</h2><p>上一章计算 <span class="math inline">\(\large {66600 \times 666000}\)</span> 时，我们将 <span class="math inline">\(\large {666 \times 666}\)</span> 化简为 <span class="math inline">\(\large {444 \times (1000 - 1)}\)</span> ，再在结果后面直接加上 <span class="math inline">\(\large {5}\)</span> 个 <span class="math inline">\(\large {0}\)</span> ，那么你有没有想过这背后隐含了什么数学思想吗？<p>下面我们正式进入今天的课题：<strong>参数归约(Argument Reduction)</strong> 。<p>为了提高数学函数的计算效率，将初始问题转变或者说缩小到函数更容易计算的域内，这就是参数归约。<p>已知函数 <span class="math inline">\(\large {f}\)</span> ，求 <span class="math inline">\(\large {y = f(x)}\)</span> 的值，可以通过以下 <span class="math inline">\(\large {3}\)</span> 个步骤进行计算：<ol type=1><li>将 <span class="math inline">\(\large {x}\)</span> 转换为缩小的参数 <span class="math inline">\(\large {x'}\)</span> ；<li>计算 <span class="math inline">\(\large {y' = f(x')}\)</span> ；<li>使用函数恒等式从 <span class="math inline">\(\large {f(x')}\)</span> 计算出 <span class="math inline">\(\large {f(x)}\)</span> 。</ol><p>现在回到上一节的小学数学计算题，我们实际上用到了 <span class="math inline">\(\large {2}\)</span> 种参数归约：<ol type=1><li>指数/对数 运算公式</ol><p><span class="math display">\[ exp(x + y) = \exp(x) \exp(y) \]</span><p><span class="math display">\[ \log (xy) = \log (x) + \log (y) \]</span><ol start=2 type=1><li>相加公式。不过上面小学数学题用的非常简单的分配律和结合律，实际上我们用的更复杂的公式，比如各种三角恒等式：</ol><p><span class="math display">\[ \sin (x + y) = \sin(x) \cos (y) + \cos (x) \sin (y) \]</span><p><span class="math display">\[ \tan (x + y) = \frac {\tan (x) + \tan (y)}{1 - \tan (x) \tan (y)} \]</span><p>实际上为了让幂级数更快地收敛，通常我们取 <span class="math inline">\(\large {x = y}\)</span> 以获得双倍公式，比如 <span class="math inline">\(\large {e^ {2x} = (e^x)^2}\)</span> ，比如 快速幂算法(Exponentiation by squaring) <a class=footnote-ref href=#fn3 id=fnref3 role=doc-noteref><sup>3</sup></a> , 其具体实现可参考这篇文章： <a href=https://www.longluo.me/blog/leetcode-powx-n/>Fast Power Algorithm: Binary Exponentiation</a> 。<p>而计算器中也常用到三倍角公式 <span class="math inline">\(\large {\sin (3x) = 3 \sin (x) - 4 \sin ^3(x)}\)</span> 去计算三角函数值，具体可参考这个视频： <a href=https://www.bilibili.com/video/BV1AW4y1A7HN rel=noopener target=_blank>计算器是如何计算出三角函数和对数的？</a> 。<p>可能有同学会问，那二倍角公式 <span class="math inline">\(\large {\sin (2x) = 2 \sin(x) \cos (x)}\)</span> 就不用了吗？这个谜底待后续章节介绍。<h2 id=如何对参数进行归约>如何对参数进行归约？</h2><p>这一章我们来讲如何进行参数归约，通常我们区分 <span class="math inline">\(\large {2}\)</span> 种参数归约：<ol type=1><li>加法参数归约： <span class="math inline">\(\large {x' = x - kC}\)</span> ，其中 <span class="math inline">\(\large {C}\)</span> 是实常数， <span class="math inline">\(\large {k}\)</span> 是整数。</ol><p>这种归约可以应用在 <span class="math inline">\(\large {f(x)}\)</span> 是周期函数的情况，比如三角函数，此时 <span class="math inline">\(\large {C = 2 \pi}\)</span> ；也可以应用于其他函数，比如小学数学我们知道计算 <span class="math inline">\(\large { \frac {a}{b}}\)</span> 就是看有多少个 <span class="math inline">\(\large {b}\)</span> 相加小于等于 <span class="math inline">\(\large {a}\)</span> ，具体可参考这篇文章：<a href=https://www.longluo.me/blog/leetcode-divide-two-integers-en/>29. Divide Two Integers</a> 。<ol start=2 type=1><li>乘法参数归约：<span class="math inline">\(\large {x' = \frac{x}{kC}}\)</span>，其中 <span class="math inline">\(\large {C}\)</span> 是实常数， <span class="math inline">\(\large {k}\)</span> 是整数。</ol><p>应用于计算指数函数 <span class="math inline">\(\large { \exp(x)}\)</span> 时，其中 <span class="math inline">\(\large {C = 2}\)</span> 。<p>值得注意的是，对于给定的函数，两种参数归约方式都可能使用。例如，对于 <span class="math inline">\(\large {\sin (x) }\)</span> ，我们既可以使用三倍角公式 <span class="math inline">\(\large {\sin (3x) = 3 \sin (x) - 4 \sin^3 (x)}\)</span> 化简，也可以使用加法归约 <span class="math inline">\(\large {\sin (x + 2 k \pi) = \sin (x)}\)</span> 。<h2 id=数值分析-numerical-analysis>数值分析 Numerical Analysis</h2><p>通过上面的分析，现在让我们去计算任意输入 <span class="math inline">\(\large {x}\)</span> 的 <span class="math inline">\(\large { \sin (x)}\)</span> 、 <span class="math inline">\(\large {\cos (x)}\)</span> 的值，可以分为下面 <span class="math inline">\(\large {2}\)</span> 种情况：<ol type=1><li><span class="math inline">\(\large {0 < x \leq \frac {\pi}{2}}\)</span> ，使用泰勒展开或者 CORDIC 算法；<li><span class="math inline">\(\large {x > \frac {\pi}{2}}\)</span> ，先将 <span class="math inline">\(\large {x}\)</span> 归约到 <span class="math inline">\(\large {x' = x + k \frac {\pi}{2}}\)</span> ，再回到第一步计算。</ol><p>听起来似乎很简单，但事实上远远没有这么容易！<p>我们的电脑是基于 <strong>二进制(Binary)</strong> <a class=footnote-ref href=#fn4 id=fnref4 role=doc-noteref><sup>4</sup></a> 的，本质只是高电平和低电平在电路上切换运行而已。因为 CPU 种的 逻辑运算单元(Arithmetic logic unit) <a class=footnote-ref href=#fn5 id=fnref5 role=doc-noteref><sup>5</sup></a> 只能做加法和移位操作，因此而诞生了 计算机算术(Computer Arithmetic) <a class=footnote-ref href=#fn6 id=fnref6 role=doc-noteref><sup>6</sup></a> 这门学科！<p>数学中有一门学科 数值分析(Numerical Analysis) <a class=footnote-ref href=#fn7 id=fnref7 role=doc-noteref><sup>7</sup></a> 就是专门研究各种计算的！<p>虽然三角函数的周棋是 <span class="math inline">\(\large {2 \pi}\)</span> ，但实际上我们只用归约到 <span class="math inline">\(\large {[-\frac {\pi}{4},\frac {\pi}{4}]}\)</span> 即可，这里大家可以想想为什么？<p>之前我以为数值运算对于 <span class="math inline">\(\large {[-\frac {\pi}{2},\frac {\pi}{2}]}\)</span> 的参数，会使用 CORDIC 算法，但实际上我看了一些数值计算库，发现对于 <span class="math inline">\(\large {[-\frac {\pi}{2},\frac {\pi}{2}]}\)</span> 还是使用泰勒(Taylor Series) <a class=footnote-ref href=#fn8 id=fnref8 role=doc-noteref><sup>8</sup></a> 逼近，当然里面用了很多技巧，大家可以看看库函数的具体实现即可解惑（这里先挖个坑，等我彻底看懂了再来这里填坑！）。<p>那对于 <span class="math inline">\(\large {x > \frac {\pi}{2}}\)</span> ，如何计算呢？<h2 id=cody-waite-归约算法>Cody-Waite 归约算法</h2><p>我们可以使用下列公式将 <span class="math inline">\(\large {x}\)</span> 归约到 <span class="math inline">\(\large {[-\frac {\pi}{4},\frac {\pi}{4}]}\)</span> ：<p><span class="math display">\[ x' = x - \lfloor \frac {x}{\frac {\pi}{2}} \rfloor \times \frac {\pi}{2} \]</span><p>我们可以很容易按照上述思想写出对应的代码，这就是 Cody & Waite 提出的 Cody-Waite 归约算法<a class=footnote-ref href=#fn9 id=fnref9 role=doc-noteref><sup>9</sup></a> 。<p>但是如果你认为这样就高枕无忧了的话，就太早了！<p>假如输入 <span class="math inline">\(\large {x = 1000001}\)</span> 的话，上面的方法就会失效！想一想为什么？<h2 id=payne-hanek-归约算法>Payne-Hanek 归约算法</h2><p>上一章提出了一个问题，有效数字 超过 <span class="math inline">\(\large {15}\)</span> 位的超大数字该如何计算呢？针对这个问题， Payne 与 Hanek <a class=footnote-ref href=#fn10 id=fnref10 role=doc-noteref><sup>10</sup></a> 提出把浮点运算转换为大整数运算，来解决超大数字的浮点数归约问题。<p>要弄懂 Payne-Hanek 归约算法，需要对数学有比较深的理解，下面一步一步来分析！<p>对于输入 <span class="math inline">\(\large {x}\)</span> ：<p><span class="math display">\[ x = k \cdot (\frac {\pi}{2}) + r \quad k \subset \mathbb{Z}, r \subset [-\frac {\pi}{4},\frac {\pi}{4}] \]</span><p>两边同乘 <span class="math inline">\(\large {\frac{2}{\pi }}\)</span> ，可得：<p><span class="math display">\[ x \cdot ( \frac{2}{\pi }) = k + r \cdot (\frac{2}{\pi }) \]</span><p>因为 <span class="math inline">\(\left| r \right | \leq \frac {\pi}{4}\)</span> ， <span class="math inline">\(r \cdot (\frac {2}{\pi }) \leq 0.5\)</span> ，也就是说：<p><span class="math display">\[ y = x \cdot (\frac {2}{\pi }) \]</span><p>即：<p><span class="math display">\[ k = \left \lfloor y \right \rfloor \]</span><p>那么所求浮点数的尾数部分：<p><span class="math display">\[ f = y − k \]</span><p>最终可得到归约之后的结果 <span class="math inline">\(\large {r}\)</span> ：<p><span class="math display">\[ r = f \cdot (\frac {\pi }{2}) \]</span><p>回到我们的目标，我们需要知道 <span class="math inline">\(\large {k}\)</span> 的值 和 <span class="math inline">\(\large {r}\)</span> 的值！<p>那我们能直接用上述公式计算吗？<p>我们知道 <span class="math inline">\(\large {\pi}\)</span> 是超越数，是无法用二进制表示的，在计算机里只能去近似。我们最终要求得的三角函数的误差取决于下面几个方面：<ol type=1><li>使用多少位数的 <span class="math inline">\(\large {\pi}\)</span> 近似值；<li>参数归约时产生的误差；<li>计算参数归约之后的三角函数时的误差。</ol><p>对于输入参数 <span class="math inline">\(\large {x}\)</span> 不是很大的情况，误差主要由参数归约时产生的误差决定，而当输入参数 <span class="math inline">\(\large {x}\)</span> 很大的情况，参数归约产生的误差就不再是主要因素了！<h2 id=计算-large-k>计算 <span class="math inline">\(\large {k}\)</span></h2><p>由之前的推导，我们知道：<p><span class="math display">\[ k = \left \lfloor y \right \rfloor = x \cdot (\frac {2}{\pi }) \]</span><p>但是由于浮点数的精度限制，我们知道对于 <span class="math inline">\(\large {x}\)</span> 很大情况，我们不能直接去计算！<p>由三角函数关系可知，我们实际上只需要计算 <span class="math inline">\(\large {k \% 4}\)</span> 的值即可，也就是说只需要知道 <span class="math inline">\(\large {k}\)</span> 的最后 <span class="math inline">\(\large {2}\)</span> 个 二进制位值即可，这样就可以节省大量运算了！<p>让我们回到 浮点数标准 <a class=footnote-ref href=#fn11 id=fnref11 role=doc-noteref><sup>11</sup></a> ，以 <span class="math inline">\(\large {32}\)</span> 位单精度浮点数为例，其值可以表示为：<p><span class="math display">\[ x = (-1)^{b_{31}} \times 2^{(b_{30}b_{29}\dots b_{23})_{2} - 127} \times (1.b_{22}b_{21}\dots b_{0})_{2} \]</span><p>即为：<p><span class="math display">\[ \text {value} = (-1)^{\text {sign}} \times 2^{(E - 127)} \times \left (1 + \sum _{i=1}^{23}b_{23-i} 2^{-i} \right) \]</span><p>(原始论文和数值分析具体实现代码太难看懂了，这篇文章写了快 1 个月了！:-( )<h2 id=小结>小结</h2><p>这是目前我对<strong>参数归约(Argument Reduction)</strong> 算法的理解，后续有新的发现、感悟都会更新此文章。<h2 id=参考文献>参考文献</h2><section class="footnotes footnotes-end-of-document" id=footnotes role=doc-endnotes><hr><ol><li id=fn1><p><a href=https://www.longluo.me/blog/cordic/>CORDIC算法：一种高效计算三角函数值的方法</a><a class=footnote-back href=#fnref1 role=doc-backlink>↩︎</a><li id=fn2><p><a href=https://www.longluo.me/blog/taylor-series/>泰勒展开式(Taylor series)</a><a class=footnote-back href=#fnref2 role=doc-backlink>↩︎</a><li id=fn3><p><a href=https://en.wikipedia.org/wiki/Exponentiation_by_squaring rel=noopener target=_blank>Exponentiation by squaring</a><a class=footnote-back href=#fnref3 role=doc-backlink>↩︎</a><li id=fn4><p><a href=https://en.wikipedia.org/wiki/Binary_number rel=noopener target=_blank>Binary number</a><a class=footnote-back href=#fnref4 role=doc-backlink>↩︎</a><li id=fn5><p><a href=https://en.wikipedia.org/wiki/Arithmetic_logic_unit rel=noopener target=_blank>Arithmetic logic unit</a><a class=footnote-back href=#fnref5 role=doc-backlink>↩︎</a><li id=fn6><p><a href=https://zh.wikipedia.org/wiki/Category:%E8%A8%88%E7%AE%97%E6%A9%9F%E7%AE%97%E8%A1%93 rel=noopener target=_blank>计算机算术</a><a class=footnote-back href=#fnref6 role=doc-backlink>↩︎</a><li id=fn7><p><a href=https://en.wikipedia.org/wiki/Numerical_analysis rel=noopener target=_blank>Numerical Analysis</a><a class=footnote-back href=#fnref7 role=doc-backlink>↩︎</a><li id=fn8><p><a href=https://www.longluo.me/blog/taylor-series/>泰勒展开式(Taylor series)</a><a class=footnote-back href=#fnref8 role=doc-backlink>↩︎</a><li id=fn9><p>W. Cody and W. Waite, Software Manual for the Elementary Functions, Prentice-Hall, Englewood Cliffs, N.J., 1980.<a class=footnote-back href=#fnref9 role=doc-backlink>↩︎</a><li id=fn10><p><a href=https://dl.acm.org/doi/pdf/10.1145/1057600.1057602 rel=noopener target=_blank>M. Payne and R. Hanek, “Radian Reduction for Trigonometric Functions”, Signum, p19-24, Jan 1983.</a><a class=footnote-back href=#fnref10 role=doc-backlink>↩︎</a><li id=fn11><p><a href=https://en.wikipedia.org/wiki/IEEE_754 rel=noopener target=_blank>IEEE 754</a><a class=footnote-back href=#fnref11 role=doc-backlink>↩︎</a></ol></section></div><footer class=post-footer><div class=reward-container><div>请我一杯咖啡吧！</div><button>赞赏</button><div class=post-reward><div><img alt="Long Luo 微信" src=https://www.longluo.me/assets/reward/wechatpay.jpeg><span>微信</span></div></div></div><div class=post-copyright><ul><li class=post-copyright-author><strong>本文作者： </strong>Long Luo<li class=post-copyright-link><strong>本文链接：</strong> <a title="参数归约算法(Argument Range Reduction)：如何在浮点数环境下计算超大数字的三角函数值？" href=https://www.longluo.me/blog/argument-range-reduction/>https://www.longluo.me/blog/argument-range-reduction/</a><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a class=social-link href=/atom.xml target=_blank> <span class=icon> <i class="fa fa-rss"></i> </span> <span class=label>RSS</span> </a></div></div></div><div class=post-tags><a href=/tags/Math/ rel=tag># Math</a><a href=/tags/Algorithm/ rel=tag># Algorithm</a><a href=/tags/Arithmetic/ rel=tag># Arithmetic</a><a href=/tags/Argument-Reduction/ rel=tag># Argument Reduction</a><a href=/tags/Computer-Arithmetic/ rel=tag># Computer Arithmetic</a><a href=/tags/Trigonometric/ rel=tag># Trigonometric</a><a href=/tags/Floating-point/ rel=tag># Floating point</a></div><div class=post-nav><div class=post-nav-item><a href=/blog/perspective/ rel=prev title=素描背后的数学> <i class="fa fa-angle-left"></i> 素描背后的数学 </a></div><div class=post-nav-item><a title="Remez Algorithm" href=/blog/remez-algorithm/ rel=next> Remez Algorithm <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div><div class=comments id=waline></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2013 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Long Luo</span></div><div class=wordcount><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-chart-line"></i> </span> <span title=站点总字数>1.6m</span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span> <span title=站点阅读时长>24:57</span> </span></div><div class=busuanzi-count><span class=post-meta-item id=busuanzi_container_site_uv> <span class=post-meta-item-icon> <i class="fa fa-user"></i> </span> <span class=site-uv title=总访客量> <span id=busuanzi_value_site_uv></span> </span> </span><span class=post-meta-item id=busuanzi_container_site_pv> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=site-pv title=总访问量> <span id=busuanzi_value_site_pv></span> </span> </span></div><div class=powered-by>由 <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/pisces/ rel=noopener target=_blank>NexT.Pisces</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><a class="book-mark-link book-mark-link-fixed" role=button></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script class=next-config data-name=waline type=application/json>{"lang":"zh-CN","enable":true,"serverURL":"https://waline.longluo.me/","cssUrl":"https://unpkg.com/@waline/client@v3/dist/waline.css","commentCount":true,"pageview":true,"libUrl":"https://unpkg.com/@waline/client@v3/dist/waline.umd.js","locale":{"placeholder":"欢迎大家的留言！(留言只需要填昵称即可，但填了email的话就可以收到博主的回复通知了！) Welcome to comment!"},"emoji":["https://unpkg.com/@waline/emojis@1.1.0/qq"],"meta":["nick","mail","link"],"requiredMeta":[["nick"]],"wordLimit":0,"pageSize":10,"reaction":"true,","el":"#waline","comment":true,"path":"/blog/argument-range-reduction/"}</script><link href=https://unpkg.com/@waline/client@v3/dist/waline.css rel=stylesheet><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});</script>