<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta content=#222 name=theme-color><meta content="Hexo 7.1.1" name=generator><link href=https://fonts.googleapis.com rel=preconnect><link href=https://unpkg.com rel=preconnect><link href=https://www.longluo.me/assets/logo/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://www.longluo.me/assets/logo/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://www.longluo.me/assets/logo/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=n6mekvZa-QaR3EnDD-CzJymq7mGubpU7rvoGpKROHLE name=google-site-verification><meta content=6BFBD4DDDB3B6F4FDD26CF82BADDB931 name=msvalidate.01><meta content=a2ab49d952ea45f5 name=yandex-verification><meta content=www.longluo.me name=baidu-site-verification><link href=/css/main.css rel=stylesheet><link as=style href=https://fonts.googleapis.com/css2?family=Noto+Serif+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Roboto+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext onload=this.rel='stylesheet' rel=preload><link as=style href=https://unpkg.com/@fortawesome/fontawesome-free@7.0.0/css/all.min.css onload=this.rel='stylesheet' rel=preload><link crossorigin=anonymous href=https://unpkg.com/animate.css@3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"www.longluo.me","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.24.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"language":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":5,"unescape":false,"preload":false}}</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/config.js></script><meta content="By Long Luo This article is the solution From Brute Force to DP to Two Pointers with Detail Explaination of Problem 42. Trapping Rain Water . Intuition   Trapping Rain Water  It’s like Leetcode 11. Co" name=description><meta content=article property=og:type><meta content="[LeetCode][42. Trapping Rain Water] From Brute Force to DP to Two Pointers with Detail Explaination" property=og:title><meta content=https://www.longluo.me/blog/leetcode-trapping-rain-water/index.html property=og:url><meta content="Long Luo's Life Notes" property=og:site_name><meta content="By Long Luo This article is the solution From Brute Force to DP to Two Pointers with Detail Explaination of Problem 42. Trapping Rain Water . Intuition   Trapping Rain Water  It’s like Leetcode 11. Co" property=og:description><meta content=zh_CN property=og:locale><meta content=https://www.longluo.me/assets/blog/images/leetcode/leetcode-42-trapping-rain-water.png property=og:image><meta content=2022-09-18T00:39:47.000Z property=article:published_time><meta content=2025-05-02T05:40:07.411Z property=article:modified_time><meta content="Long Luo" property=article:author><meta content=Algorithm property=article:tag><meta content=Leetcode property=article:tag><meta content="Dynamic Programming" property=article:tag><meta content="Two Pointers" property=article:tag><meta content=summary name=twitter:card><meta content=https://www.longluo.me/assets/blog/images/leetcode/leetcode-42-trapping-rain-water.png name=twitter:image><link href=https://www.longluo.me/blog/leetcode-trapping-rain-water/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.longluo.me/blog/leetcode-trapping-rain-water/","path":"/blog/leetcode-trapping-rain-water/","title":"[LeetCode][42. Trapping Rain Water] From Brute Force to DP to Two Pointers with Detail Explaination"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>[LeetCode][42. Trapping Rain Water] From Brute Force to DP to Two Pointers with Detail Explaination | Long Luo's Life Notes</title><script async src=https://www.googletagmanager.com/gtag/js?id=UA-46213499-2></script><script class=next-config data-name=google_analytics type=application/json>{"tracking_id":"UA-46213499-2","only_pageview":false,"measure_protocol_api_secret":null}</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/analytics/google-analytics.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?a75fb5d0c0ef1e36c34b7f52bb7c48be></script><script async src=https://assets.growingio.com/2.1/gio.js></script><script class=next-config data-name=growingio_analytics type=application/json>"bc65befc551b6d70"</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/analytics/growingio.js></script><script>(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "gz2vdkhgvh");</script><script data-domain=longluo.me defer src=https://plausible.io/js/script.js></script><script crossorigin=anonymous defer integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://unpkg.com/animejs@3.2.1/lib/anime.min.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/utils.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/motion.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/sidebar.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/next-boot.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/bookmark.js></script><script crossorigin=anonymous defer integrity=sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg= src=https://unpkg.com/hexo-generator-searchdb@1.5.0/dist/search.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/search/local-search.js></script><script async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script class=next-config data-name=enableMath type=application/json>true</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"ams","js":{"url":"https://unpkg.com/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script defer src=https://unpkg.com/hexo-theme-next@8.24.1/source/js/third-party/math/mathjax.js></script><link href=https://waline.longluo.me/ rel=dns-prefetch><noscript><link href=/css/noscript.css rel=stylesheet></noscript><link title="Long Luo's Life Notes" href=/atom.xml rel=alternate type=application/atom+xml><link title="Long Luo's Life Notes" href=/rss2.xml rel=alternate type=application/rss+xml><style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>Long Luo's Life Notes</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>每一天都是奇迹</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-works"><a href=/works rel=section><i class="fa fa-code fa-fw"></i>作品</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-links"><a href=/links/ rel=section><i class="fa fa-link fa-fw"></i>友链</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#intuition><span class=nav-number>1.</span> <span class=nav-text>Intuition</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#brute-force><span class=nav-number>2.</span> <span class=nav-text>1. Brute Force</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#analysis><span class=nav-number>2.1.</span> <span class=nav-text>Analysis</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#calculate-by-column><span class=nav-number>3.</span> <span class=nav-text>2. Calculate by Column</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#analysis-1><span class=nav-number>3.1.</span> <span class=nav-text>Analysis</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#dynamic-programming><span class=nav-number>4.</span> <span class=nav-text>3. Dynamic Programming</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#analysis-2><span class=nav-number>4.1.</span> <span class=nav-text>Analysis</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#two-pointers><span class=nav-number>5.</span> <span class=nav-text>4. Two Pointers</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#analysis-3><span class=nav-number>5.1.</span> <span class=nav-text>Analysis</span></a></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt="Long Luo" class=site-author-image itemprop=image src=https://www.longluo.me/assets/avatar/sinc-3d-python.png><p class=site-author-name itemprop=name>Long Luo<div class=site-description itemprop=description>A Curious Engineer</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>349</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>28</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>429</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/longluo" href=https://github.com/longluo target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="ZhiHu → http://www.zhihu.com/people/longluo" href=http://www.zhihu.com/people/longluo target=_blank><i class="fab fa-quora fa-fw"></i>ZhiHu</a> </span><span class=links-of-author-item> <a rel="noopener me" title="LinkedIn → https://www.linkedin.com/in/longluo/" href=https://www.linkedin.com/in/longluo/ target=_blank><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a> </span><span class=links-of-author-item> <a rel="noopener me" title="E-Mail → mailto:luolong0226@163.com" href=mailto:luolong0226@163.com target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><img alt="Creative Commons" src=https://unpkg.com/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div><div class="sidebar-inner sidebar-blogroll"><div class="links-of-blogroll animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i> 链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://blog.csdn.net/tcpipstack rel=noopener target=_blank title=http://blog.csdn.net/tcpipstack>My CSDN</a></ul></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://www.longluo.me/blog/leetcode-trapping-rain-water/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc-3d-python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="[LeetCode][42. Trapping Rain Water] From Brute Force to DP to Two Pointers with Detail Explaination | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>[LeetCode][42. Trapping Rain Water] From Brute Force to DP to Two Pointers with Detail Explaination<a class=post-edit-link href=https://github.com/longluo/blog/tree/master/source/_posts/leetcode-trapping-rain-water.md rel=noopener target=_blank title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2022-09-18 08:39:47" datetime=2022-09-18T08:39:47+08:00>2022-09-18</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-05-02 13:40:07" datetime=2025-05-02T13:40:07+08:00 itemprop=dateModified>2025-05-02</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Leetcode/ itemprop=url rel=index><span itemprop=name>Leetcode</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/leetcode-trapping-rain-water/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/leetcode-trapping-rain-water/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/leetcode-trapping-rain-water/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>4.8k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>4 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p>This article is the solution <a href=https://leetcode.com/problems/trapping-rain-water/discuss/2589758/from-brute-force-to-dp-then-two-pointers-with-detail-explaination rel=noopener target=_blank>From Brute Force to DP to Two Pointers with Detail Explaination</a> of Problem <a href=https://leetcode.com/problems/trapping-rain-water/ rel=noopener target=_blank>42. Trapping Rain Water</a> .<h2 id=intuition>Intuition</h2><figure><img alt="Trapping Rain Water" src=https://www.longluo.me/assets/blog/images/leetcode/leetcode-42-trapping-rain-water.png><figcaption aria-hidden=true>Trapping Rain Water</figcaption></figure><p>It’s like <a href=https://leetcode.com/problems/container-with-most-water/ rel=noopener target=_blank>Leetcode 11. Container With Most Water</a> , we can consider the black block as a wall, the blue block as water. Given an array, each element represents the height of the wall from left to right, find out how many units of water can be held.<p>The solution can be refered <a href=https://leetcode.com/problems/container-with-most-water/discuss/1915231/java-2-approaches-bf-and-two-pointers-with-image-explaination-code-commented rel=noopener target=_blank>2 Approaches: BF and Two Pointers with Image Explaination</a> .<h2 id=brute-force>1. Brute Force</h2><p>It’s easy to use the brute force approach. The time complexity is <span class="math inline">\(O(max^n)\)</span> , so it will <strong>TLE</strong>.<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre><td class=code><pre><span class=line><span class=comment>// Row time: O(max * n) space: O(1)</span></span><br><span class=line><span class=comment>// TLE</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>static</span> <span class=type>int</span> <span class="title function_">trap_row</span><span class=params>(<span class=type>int</span>[] height)</span> {</span><br><span class=line>    <span class=keyword>if</span> (height == <span class=literal>null</span> || height.length <= <span class=number>2</span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=type>int</span> <span class=variable>ans</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=type>int</span> <span class=variable>len</span> <span class=operator>=</span> height.length;</span><br><span class=line>    <span class=type>int</span> <span class=variable>maxHeight</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> x : height) {</span><br><span class=line>        maxHeight = Math.max(maxHeight, x);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>1</span>; i <= maxHeight; i++) {</span><br><span class=line>        <span class=type>boolean</span> <span class=variable>flag</span> <span class=operator>=</span> <span class=literal>false</span>;</span><br><span class=line>        <span class=type>int</span> <span class=variable>water</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>j</span> <span class=operator>=</span> <span class=number>0</span>; j < len; j++) {</span><br><span class=line>            <span class=keyword>if</span> (flag && height[j] < i) {</span><br><span class=line>                water++;</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            <span class=keyword>if</span> (height[j] >= i) {</span><br><span class=line>                ans += water;</span><br><span class=line>                water = <span class=number>0</span>;</span><br><span class=line>                flag = <span class=literal>true</span>;</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> ans;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=analysis>Analysis</h3><ul><li><strong>Time Complexity</strong>: <span class="math inline">\(O(max^n)\)</span><li><strong>Space Complexity</strong>: <span class="math inline">\(O(1)\)</span></ul><span id=more></span><h2 id=calculate-by-column>2. Calculate by Column</h2><p>To find the water in each column, we only need to focus on:<ol type=1><li>Current column;<li>The highest wall on the left;<li>The highest wall on the right.</ol><p>To find how much water filled, we only need to look at the shorter one of the tallest wall on the left and the tallest wall on the right.<p>Therefore, according to the height of the shorter wall and the wall of the current column, it can be divided into three cases.<ol type=1><li><span class="math inline">\(min(leftMax, rightMax) > current\)</span>:</ol><p>Imagine pouring water between the tallest walls on either side. How much water will the column being asked for?<p>Obviously, the shorter side, which is the height of the wall on the left, minus the height of the current column, which is <span class="math inline">\(2 - 1 = 1\)</span>, can store one unit of water.<ol start=2 type=1><li><span class="math inline">\(min(leftMax, rightMax) < current\)</span>:</ol><p>Imagine pouring water between the tallest walls on either side. How much water will the column being asked for?<p>The column being sought will not have water because it is larger than the lower walls on either side.<ol start=3 type=1><li><span class="math inline">\(min(leftMax, rightMax) == current\)</span> :</ol><p>As in the previous case, there will be no water.<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br></pre><td class=code><pre><span class=line><span class=comment>// Col time: O(n^2) space: O(1)</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>static</span> <span class=type>int</span> <span class="title function_">trap_col</span><span class=params>(<span class=type>int</span>[] height)</span> {</span><br><span class=line>    <span class=keyword>if</span> (height == <span class=literal>null</span> || height.length <= <span class=number>2</span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=type>int</span> <span class=variable>ans</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=type>int</span> <span class=variable>len</span> <span class=operator>=</span> height.length;</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>1</span>; i < len - <span class=number>1</span>; i++) {</span><br><span class=line>        <span class=type>int</span> <span class=variable>maxRight</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>        <span class=type>int</span> <span class=variable>maxLeft</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>right</span> <span class=operator>=</span> i; right < len; right++) {</span><br><span class=line>            maxRight = Math.max(maxRight, height[right]);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>left</span> <span class=operator>=</span> i; left >= <span class=number>0</span>; left--) {</span><br><span class=line>            maxLeft = Math.max(maxLeft, height[left]);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        ans += Math.min(maxLeft, maxRight) - height[i];</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> ans;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=analysis-1>Analysis</h3><ul><li><strong>Time Complexity</strong>: <span class="math inline">\(O(n^2)\)</span><li><strong>Space Complexity</strong>: <span class="math inline">\(O(1)\)</span></ul><h2 id=dynamic-programming>3. Dynamic Programming</h2><p>In Approache 2, for each column, we have to traverse all the heights to get the tallest wall on the left and the tallest wall on the right, we can optimize it.<p>We can use <strong>extra space</strong> to tradeoff the time complexity.<p>Use two arrays, <span class="math inline">\(max_left[i]\)</span> and <span class="math inline">\(max_right[i]\)</span>, which represents the height of the tallest wall on the left or right of column <span class="math inline">\(i\)</span>.<p><span class="math inline">\(max_left[i] = Max(max_left[i-1], height[i-1])\)</span>. Choose the higher height on the left side of the wall in front of it and the height of the wall in front of it, which is the highest wall on the left side of the current column.<p><span class="math inline">\(max_right[i] = Max(max_right[i+1],height[i+1])\)</span>. The highest height on the right side of the wall behind it and the height of the wall behind it choose a larger one, which is the highest wall on the right side of the current column.<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br></pre><td class=code><pre><span class=line><span class=comment>// DP time: O(n) space: O(n)</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>static</span> <span class=type>int</span> <span class="title function_">trap_dp</span><span class=params>(<span class=type>int</span>[] height)</span> {</span><br><span class=line>    <span class=keyword>if</span> (height == <span class=literal>null</span> || height.length <= <span class=number>2</span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=type>int</span> <span class=variable>ans</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=type>int</span> <span class=variable>len</span> <span class=operator>=</span> height.length;</span><br><span class=line>    <span class=type>int</span>[] leftMax = <span class=keyword>new</span> <span class="title class_">int</span>[len];</span><br><span class=line>    <span class=type>int</span>[] rightMax = <span class=keyword>new</span> <span class="title class_">int</span>[len];</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>1</span>; i < len - <span class=number>1</span>; i++) {</span><br><span class=line>        leftMax[i] = Math.max(leftMax[i - <span class=number>1</span>], height[i - <span class=number>1</span>]);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> len - <span class=number>2</span>; i >= <span class=number>0</span>; i--) {</span><br><span class=line>        rightMax[i] = Math.max(rightMax[i + <span class=number>1</span>], height[i + <span class=number>1</span>]);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>1</span>; i < len - <span class=number>1</span>; i++) {</span><br><span class=line>        <span class=type>int</span> <span class=variable>min</span> <span class=operator>=</span> Math.min(leftMax[i], rightMax[i]);</span><br><span class=line>        ans += min > height[i] ? min - height[i] : <span class=number>0</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> ans;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=analysis-2>Analysis</h3><ul><li><strong>Time Complexity</strong>: <span class="math inline">\(O(n)\)</span><li><strong>Space Complexity</strong>: <span class="math inline">\(O(n)\)</span></ul><h2 id=two-pointers>4. Two Pointers</h2><p>In DP Approach, we can often optimize the space complexity.<p>We can see that the elements in the <span class="math inline">\(max_left[i]\)</span> and <span class="math inline">\(max_right[i]\)</span> arrays are actually only used <strong>once</strong>, and then never used again. So we can use just use one element instead of an array.<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre><td class=code><pre><span class=line><span class=comment>// Two Pointers time: O(n) space: O(1)</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>static</span> <span class=type>int</span> <span class="title function_">trap_tp_opt</span><span class=params>(<span class=type>int</span>[] height)</span> {</span><br><span class=line>    <span class=keyword>if</span> (height == <span class=literal>null</span> || height.length <= <span class=number>2</span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=type>int</span> <span class=variable>len</span> <span class=operator>=</span> height.length;</span><br><span class=line>    <span class=type>int</span> <span class=variable>ans</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=type>int</span> <span class=variable>left</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=type>int</span> <span class=variable>right</span> <span class=operator>=</span> len - <span class=number>1</span>;</span><br><span class=line>    <span class=type>int</span> <span class=variable>leftMax</span> <span class=operator>=</span> height[<span class=number>0</span>];</span><br><span class=line>    <span class=type>int</span> <span class=variable>rightMax</span> <span class=operator>=</span> height[right];</span><br><span class=line>    <span class=keyword>while</span> (left < right) {</span><br><span class=line>        <span class=keyword>if</span> (height[left] < height[right]) {</span><br><span class=line>            leftMax = Math.max(leftMax, height[left]);</span><br><span class=line>            ans += leftMax - height[left];</span><br><span class=line>            left++;</span><br><span class=line>        } <span class=keyword>else</span> {</span><br><span class=line>            rightMax = Math.max(rightMax, height[right]);</span><br><span class=line>            ans += rightMax - height[right];</span><br><span class=line>            right--;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> ans;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=analysis-3>Analysis</h3><ul><li><strong>Time Complexity</strong>: <span class="math inline">\(O(n)\)</span><li><strong>Space Complexity</strong>: <span class="math inline">\(O(1)\)</span></ul><hr><p>All suggestions are welcome. If you have any query or suggestion please comment below. Please upvote👍 if you like💗 it. Thank you:-)<p>Explore More <a href=https://www.longluo.me/blog/leetcode-solutions/>Leetcode Solutions</a>. 😉😃💗</div><footer class=post-footer><div class=reward-container><div>请我一杯咖啡吧！</div><button>赞赏</button><div class=post-reward><div><img alt="Long Luo 微信" src=https://www.longluo.me/assets/reward/wechatpay.jpeg><span>微信</span></div></div></div><div class=post-copyright><ul><li class=post-copyright-author><strong>本文作者： </strong>Long Luo<li class=post-copyright-link><strong>本文链接：</strong> <a title="[LeetCode][42. Trapping Rain Water] From Brute Force to DP to Two Pointers with Detail Explaination" href=https://www.longluo.me/blog/leetcode-trapping-rain-water/>https://www.longluo.me/blog/leetcode-trapping-rain-water/</a><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a class=social-link href=/atom.xml target=_blank> <span class=icon> <i class="fa fa-rss"></i> </span> <span class=label>RSS</span> </a></div></div></div><div class=post-tags><a href=/tags/Algorithm/ rel=tag># Algorithm</a><a href=/tags/Leetcode/ rel=tag># Leetcode</a><a href=/tags/Dynamic-Programming/ rel=tag># Dynamic Programming</a><a href=/tags/Two-Pointers/ rel=tag># Two Pointers</a></div><div class=post-nav><div class=post-nav-item><a title="最短路径问题：重新发明 Dijkstra 算法" href=/blog/dijkstra/ rel=prev> <i class="fa fa-angle-left"></i> 最短路径问题：重新发明 Dijkstra 算法 </a></div><div class=post-nav-item><a title="[LeetCode][19. Remove Nth Node From End of List] 3 Approaches: Brute Force, Stack, Slow Fast Pointers with Animation" href=/blog/leetcode-remove-nth-node-from-end-of-list/ rel=next> [LeetCode][19. Remove Nth Node From End of List] 3 Approaches: Brute Force, Stack, Slow Fast Pointers with Animation <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div><div class=comments id=waline></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2013 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Long Luo</span></div><div class=wordcount><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-chart-line"></i> </span> <span title=站点总字数>1.6m</span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span> <span title=站点阅读时长>24:57</span> </span></div><div class=busuanzi-count><span class=post-meta-item id=busuanzi_container_site_uv> <span class=post-meta-item-icon> <i class="fa fa-user"></i> </span> <span class=site-uv title=总访客量> <span id=busuanzi_value_site_uv></span> </span> </span><span class=post-meta-item id=busuanzi_container_site_pv> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=site-pv title=总访问量> <span id=busuanzi_value_site_pv></span> </span> </span></div><div class=powered-by>由 <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/pisces/ rel=noopener target=_blank>NexT.Pisces</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><a class="book-mark-link book-mark-link-fixed" role=button></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script class=next-config data-name=waline type=application/json>{"lang":"zh-CN","enable":true,"serverURL":"https://waline.longluo.me/","cssUrl":"https://unpkg.com/@waline/client@v3/dist/waline.css","commentCount":true,"pageview":true,"libUrl":"https://unpkg.com/@waline/client@v3/dist/waline.umd.js","locale":{"placeholder":"欢迎大家的留言！(留言只需要填昵称即可，但填了email的话就可以收到博主的回复通知了！) Welcome to comment!"},"emoji":["https://unpkg.com/@waline/emojis@1.1.0/qq"],"meta":["nick","mail","link"],"requiredMeta":[["nick"]],"wordLimit":0,"pageSize":10,"reaction":"true,","el":"#waline","comment":true,"path":"/blog/leetcode-trapping-rain-water/"}</script><link href=https://unpkg.com/@waline/client@v3/dist/waline.css rel=stylesheet><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});</script>