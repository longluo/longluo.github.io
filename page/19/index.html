<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta content=#222 name=theme-color><meta content="Hexo 7.1.1" name=generator><link href=https://fonts.googleapis.com rel=preconnect><link href=https://unpkg.com rel=preconnect><link href=https://www.longluo.me/assets/logo/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://www.longluo.me/assets/logo/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://www.longluo.me/assets/logo/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=n6mekvZa-QaR3EnDD-CzJymq7mGubpU7rvoGpKROHLE name=google-site-verification><meta content=6BFBD4DDDB3B6F4FDD26CF82BADDB931 name=msvalidate.01><meta content=a2ab49d952ea45f5 name=yandex-verification><meta content=www.longluo.me name=baidu-site-verification><link href=/css/main.css rel=stylesheet><link as=style href=https://fonts.googleapis.com/css2?family=Noto+Serif+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Roboto+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext onload=this.rel='stylesheet' rel=preload><link as=style href=https://unpkg.com/@fortawesome/fontawesome-free@6.7.2/css/all.min.css onload=this.rel='stylesheet' rel=preload><link crossorigin=anonymous href=https://unpkg.com/animate.css@3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"www.longluo.me","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.23.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"language":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":5,"unescape":false,"preload":false,"trigger":"auto"}}</script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/config.js></script><meta content="A Curious Engineer" name=description><meta content=website property=og:type><meta content="Long Luo's Life Notes" property=og:title><meta content=https://www.longluo.me/page/19/index.html property=og:url><meta content="Long Luo's Life Notes" property=og:site_name><meta content="A Curious Engineer" property=og:description><meta content=zh_CN property=og:locale><meta content="Long Luo" property=article:author><meta content="longluo, Tech, Tech Blog, 技术博客, Personal Blog, 个人博客, Blogger, 博客, Math, 数学, Physics, 物理, Software Engineer, 软件工程师, Program, 编程, 程序员, 码农, Java, C, C++, Data Structures, 数据结构, Algorithm, 算法, Life, 生活," property=article:tag><meta content=summary name=twitter:card><link href=https://www.longluo.me/page/19/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/19/index.html","title":""}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Long Luo's Life Notes</title><script async src=https://www.googletagmanager.com/gtag/js?id=UA-46213499-2></script><script class=next-config data-name=google_analytics type=application/json>{"tracking_id":"UA-46213499-2","only_pageview":false,"measure_protocol_api_secret":null}</script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/third-party/analytics/google-analytics.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?a75fb5d0c0ef1e36c34b7f52bb7c48be></script><script async src=https://assets.growingio.com/2.1/gio.js></script><script class=next-config data-name=growingio_analytics type=application/json>"bc65befc551b6d70"</script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/third-party/analytics/growingio.js></script><script>(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "gz2vdkhgvh");</script><script data-domain=longluo.me defer src=https://plausible.io/js/script.js></script><script crossorigin=anonymous defer integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://unpkg.com/animejs@3.2.1/lib/anime.min.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/utils.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/motion.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/sidebar.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/next-boot.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/bookmark.js></script><script crossorigin=anonymous defer integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://unpkg.com/hexo-generator-searchdb@1.4.1/dist/search.js></script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/third-party/search/local-search.js></script><script async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script class=next-config data-name=enableMath type=application/json>true</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"ams","js":{"url":"https://unpkg.com/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script defer src=https://unpkg.com/hexo-theme-next@8.23.1/source/js/third-party/math/mathjax.js></script><link href=https://waline.longluo.me/ rel=dns-prefetch><noscript><link href=/css/noscript.css rel=stylesheet></noscript><style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style><link title="Long Luo's Life Notes" href=/atom.xml rel=alternate type=application/atom+xml><link title="Long Luo's Life Notes" href=/rss2.xml rel=alternate type=application/rss+xml><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <h1 class=site-title>Long Luo's Life Notes</h1> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>每一天都是奇迹</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-works"><a href=/works rel=section><i class="fa fa-code fa-fw"></i>作品</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-links"><a href=/links/ rel=section><i class="fa fa-link fa-fw"></i>友链</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt="Long Luo" class=site-author-image itemprop=image src=https://www.longluo.me/assets/avatar/sinc-3d-python.png><p class=site-author-name itemprop=name>Long Luo<div class=site-description itemprop=description>A Curious Engineer</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>349</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>27</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>426</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/longluo" href=https://github.com/longluo target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="ZhiHu → http://www.zhihu.com/people/longluo" href=http://www.zhihu.com/people/longluo target=_blank><i class="fab fa-quora fa-fw"></i>ZhiHu</a> </span><span class=links-of-author-item> <a rel="noopener me" title="LinkedIn → https://www.linkedin.com/in/longluo/" href=https://www.linkedin.com/in/longluo/ target=_blank><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a> </span><span class=links-of-author-item> <a rel="noopener me" title="E-Mail → mailto:luolong0226@163.com" href=mailto:luolong0226@163.com target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><img alt="Creative Commons" src=https://unpkg.com/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div><div class="sidebar-inner sidebar-blogroll"><div class="links-of-blogroll animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i> 链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://blog.csdn.net/tcpipstack rel=noopener target=_blank title=http://blog.csdn.net/tcpipstack>My CSDN</a></ul></div></div></aside></div><div class="main-inner index posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/number-theoretic-transform/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc-3d-python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content=" | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/number-theoretic-transform/ itemprop=url>快速数论变换(Number Theoretic Transform)</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2022-05-01 06:55:21" datetime=2022-05-01T06:55:21+08:00>2022-05-01</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-05-02 15:49:29" datetime=2025-05-02T15:49:29+08:00 itemprop=dateModified>2025-05-02</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Data-Structures-and-Algorithms/ itemprop=url rel=index><span itemprop=name>Data Structures and Algorithms</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/number-theoretic-transform/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/number-theoretic-transform/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/number-theoretic-transform/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>3.5k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>3 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p>之前的文章 <a href=https://www.longluo.me/blog/fft/>快速傅里叶变换(FFT)算法</a> 和 <a href=https://www.longluo.me/blog/fft-optimization/>快速傅里叶变换(FFT)算法的实现及优化</a> 详细介绍了 <span class="math inline">\(\textit{FFT}\)</span> 的具体实现及其实现。<p><span class="math inline">\(\textit{FFT}\)</span> 优点很多，但缺点也很明显。例如单位复根的实部和虚部分别是一个正弦及余弦函数，有大量浮点数计算，计算量很大，而且浮点数运算产生的误差会比较大。<p>如果我们操作的对象都是整数的话，其实数学家已经发现了一个更好的方法：快速数论变换 <span class="math inline">\(\textit{(Number Theoretic Transform)}\)</span> <a class=footnote-ref href=#fn1 id=fnref1 role=doc-noteref><sup>1</sup></a>。<h2 id=快速数论变换ntt>快速数论变换(NTT)</h2><p><span class="math inline">\(\textit{FFT}\)</span> 的本质是什么？<ul><li>将卷积操作变成了<strong>乘法</strong>操作。</ul><p>是什么让 <span class="math inline">\(\textit{FFT}\)</span> 做到了 <span class="math inline">\(O(n \log n)\)</span> 的复杂度？<ul><li>是<strong>单位复根</strong>。</ul><p>那有没有什么其他的东西也拥有单位根的这些性质呢？<p>答案当然是有的，<strong>原根</strong><a class=footnote-ref href=#fn2 id=fnref2 role=doc-noteref><sup>2</sup></a> 就具有和单位根一样的性质。<p>所以快速数论变换 <span class="math inline">\(\textit{NTT}\)</span> 就是以数论为基础的具有循环卷积性质的，用有限域上的单位根来取代复平面上的单位根的 <span class="math inline">\(\textit{FFT}\)</span>。<h2 id=原根>原根</h2><p>仿照单位复数根的形式，也将原根的取值看成一个圆，不过这个圆上只有有限个点，每个点表达的是模数的剩余系中的值。<p>在 <span class="math inline">\(\textit{FFT}\)</span> 中，我们总共用到了单位复根的这些性质：<ol type=1><li><span class="math inline">\(n\)</span> 个单位复根互不相同；<li><span class="math inline">\(\omega_n^k = \omega_{2n}^{2k}\)</span>；<li><span class="math inline">\(\omega_n^{k} = -\omega_n^{k+n/2}\)</span>；<li><span class="math inline">\(\omega_n^a \times \omega_n^b = \omega_n^{a+b}\)</span>。</ol><p>我们发现原根具有和单位复根一样的性质，简单证明<a class=footnote-ref href=#fn3 id=fnref3 role=doc-noteref><sup>3</sup></a> ：<p>令 <span class="math inline">\(n\)</span> 为大于 <span class="math inline">\(1\)</span> 的 <span class="math inline">\(2\)</span> 的幂，<span class="math inline">\(p\)</span> 为素数且 <span class="math inline">\(n \mid (p-1)\)</span>，<span class="math inline">\(g\)</span> 为 <span class="math inline">\(p\)</span> 的一个原根。<p>我们设 <span class="math inline">\(g_n = g^{\frac{p-1}{n}}\)</span>：<ol type=1><li><p><span class="math inline">\(g_n^n=g^{n \cdot \frac{p-1}{n}}=g^{p-1}\)</span><li><p><span class="math inline">\(g_n^{\frac{n}{2}} = g^{\frac{p-1}{2}}\)</span><li><p><span class="math inline">\(g_{an}^{ak} = g^{\frac{ak(p-1)}{an}} = g^{\frac{k(p-1)}{n}}=g_n^k\)</span></ol><p>显然<ol type=1><li><p><span class="math inline">\(g_n^n \equiv 1 \pmod p\)</span><li><p><span class="math inline">\(g_n^{\frac{n}{2}} \equiv -1 \pmod p\)</span><li><p><span class="math inline">\((g_n^{k+\frac{n}{2}})^2=g_n^{2k+n} \equiv g_n^{2k} \pmod p\)</span></ol><p>证毕。<p>所以将 <span class="math inline">\(g_n^k\)</span> 和 <span class="math inline">\(g_n^{k+\frac{n}2}\)</span> 带入本质上和将 <span class="math inline">\(\omega_n^{k}\)</span> 和 <span class="math inline">\(\omega_n^{k+\frac{n}{2}}\)</span> 带入的操作无异。<p>利用 Vandermonde 矩阵性质，类似 <span class="math inline">\(\textit{NTT}\)</span> 那样，我们可以从 <span class="math inline">\(\textit{NTT}\)</span> 变换得到逆变换 <span class="math inline">\(\textit{INTT}\)</span> 变换，设 <span class="math inline">\(x(n)\)</span> 为整数序列，则有：<p><span class="math inline">\(\textit{NTT}\)</span> : <span class="math inline">\(X(m) = \sum \limits_{i=0}^{N}x(n)a^{mn} \pmod M\)</span><p><span class="math inline">\(\textit{INTT}\)</span> : <span class="math inline">\(X(m) = N^{-1}\sum \limits_{i=0}^{N}x(n)a^{-mn} \pmod M\)</span><p>这里 <span class="math inline">\(N^{-1}\)</span> ，<span class="math inline">\(a^{-mn} \pmod M\)</span> 为模意义下的乘法逆元。<p>当然， <span class="math inline">\(\textit{NTT}\)</span> 也是有自己的缺点的：比如不能够处理小数的情况，以及不能够处理没有模数的情况。对于模数的选取也有一定的要求，首先是必须要有原根，其次是必须要是 <span class="math inline">\(2\)</span> 的较高幂次的倍数。<!--noindex--><div class=post-button><a class=btn href=/blog/number-theoretic-transform/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/fft-optimization/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc-3d-python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content=" | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/fft-optimization/ itemprop=url>快速傅里叶变换(FFT)算法的实现及优化</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2022-04-29 07:15:32" datetime=2022-04-29T07:15:32+08:00>2022-04-29</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-05-02 12:42:21" datetime=2025-05-02T12:42:21+08:00 itemprop=dateModified>2025-05-02</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Data-Structures-and-Algorithms/ itemprop=url rel=index><span itemprop=name>Data Structures and Algorithms</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/fft-optimization/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/fft-optimization/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/fft-optimization/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>6.5k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>6 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p>之前的文章 <a href=https://www.longluo.me/blog/fft/>快速傅里叶变换(FFT)算法</a> 详细介绍了 <span class="math inline">\(\textit{FFT}\)</span> 的具体实现，也实现了<strong>分治版</strong>的 <span class="math inline">\(\textit{FFT}\)</span>。<p>分治版 <span class="math inline">\(\textit{FFT}\)</span> 代码很容易理解，但<strong>递归</strong>会消耗 <span class="math inline">\(O(\log n)\)</span> 的栈空间，同时代码实现中还有很多优化空间，这篇文章我们就来优化 <span class="math inline">\(\textit{FFT}\)</span> 下的实现。<h2 id=cooley-tukey-fft-algorithm>Cooley-Tukey FFT Algorithm</h2><p><span class="math inline">\(\textit{Cooley-Tukey FFT Algorithm}\)</span> <a class=footnote-ref href=#fn1 id=fnref1 role=doc-noteref><sup>1</sup></a> 通过使用分治算法<a class=footnote-ref href=#fn2 id=fnref2 role=doc-noteref><sup>2</sup></a> 实现将复杂问题简单化。<h3 id=fft-分治过程>FFT 分治过程</h3><figure><img alt="图1. Cooley-Tukey FFT 算法步骤" src=https://www.longluo.me/assets/blog/images/fft/cooley-tukey-general.png><figcaption aria-hidden=true>图1. Cooley-Tukey FFT 算法步骤</figcaption></figure><p>具体操作流程可以分为 <span class="math inline">\(3\)</span> 步：<ol type=1><li>Divide：按照奇偶分为 <span class="math inline">\(2\)</span> 个子问题。<li>Conquer：递归处理 <span class="math inline">\(2\)</span> 个子问题<li>Combine：合并 <span class="math inline">\(2\)</span> 个子问题。</ol><h3 id=蝴蝶操作>蝴蝶操作</h3><p>分治的前 <span class="math inline">\(2\)</span> 步之前已经详细讲述过了，第 <span class="math inline">\(3\)</span> 步合并操作是通过<strong>蝴蝶操作(Butterfly Operations)</strong>来实现的，其示意图如下所示：<figure><img alt="图2. Butterfly Operations" src=https://www.longluo.me/assets/blog/images/fft/dit-fft-butterfly.svg><figcaption aria-hidden=true>图2. Butterfly Operations</figcaption></figure><p>蝴蝶操作可能会让人看了一头雾水，不过没关系，我们一步一步来，彻底弄懂她！<h2 id=空间优化>空间优化</h2><p>回顾之前的 <a href=https://www.longluo.me/blog/fft/>递归版代码</a> ，在合并这一步，这一层有 <span class="math inline">\(n\)</span> 项需要处理，我们新建了一个数组 <span class="math inline">\(y(n)\)</span>，这是为什么呢？<p>我们可以复用之前的 <span class="math inline">\(y_e\)</span> 或 <span class="math inline">\(y_o\)</span> 数组以降低空间复杂度吗？<p>先看下合并需要做的操作：<p><span class="math display">\[ y(k) = y_e(k) + \omega_{n}^{k} \cdot y_o(k + \frac{n}{2}) \]</span><p><span class="math display">\[ y(k + \frac{n}{2}) = y_e(k) - \omega_{n}^{k} \cdot y_o(k + \frac{n}{2}) \]</span><p>很明显，我们如果复用 <span class="math inline">\(y_e\)</span> 或 <span class="math inline">\(y_o\)</span> 数组的话，那 <span class="math inline">\(y(k)\)</span> 和 <span class="math inline">\(y(k + \frac{n}{2})\)</span> 至少有一个数据会受影响，所以我们需要额外的 <span class="math inline">\(y(n)\)</span> 数组来存储数据。<p>那么有没有办法来做到复用 <span class="math inline">\(y_e\)</span> 或 <span class="math inline">\(y_o\)</span> 数组呢？<p>当然可以！<p>我们只要将修改下合并顺序，加入一个临时变量 <span class="math inline">\(t = \omega_{n}^{k} \cdot y_e(k + \frac{n}{2})\)</span> ，合并过程就可以在原数组中进行：<p><span class="math display">\[ cd \; t = \omega_{n}^{k} \cdot y_e(k+\frac{n}{2}) \]</span><p><span class="math display">\[ y_e(k+\frac{n}{2}) = y_e(k) - t \]</span><p><span class="math display">\[ y_e(k) = y_e(k)+t \]</span><p>这样就可以原地进行了，不再需要额外数组。<!--noindex--><div class=post-button><a class=btn href=/blog/fft-optimization/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/leetcode-rotate-function/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc-3d-python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content=" | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/leetcode-rotate-function/ itemprop=url>[Leetcode][396. 旋转函数] 3种方法：暴力法，动态规划，前缀和 + 滑动窗口</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2022-04-22 07:26:35" datetime=2022-04-22T07:26:35+08:00>2022-04-22</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-05-02 13:43:27" datetime=2025-05-02T13:43:27+08:00 itemprop=dateModified>2025-05-02</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Leetcode/ itemprop=url rel=index><span itemprop=name>Leetcode</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/leetcode-rotate-function/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/leetcode-rotate-function/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/leetcode-rotate-function/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>3k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>3 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p><a href=https://leetcode.cn/problems/rotate-function rel=noopener target=_blank>Leetcode 396. 旋转函数</a> 题解。<h2 id=方法一-暴力法>方法一： 暴力法</h2><p><strong>思路与算法</strong><p>很容易想到的方法是遍历，使用 <span class="math inline">\(2\)</span> 个循环，很明显最多只能有 <span class="math inline">\(len\)</span> 次旋转，因为<strong>对称性</strong>，所以数组下标可能会 <span class="math inline">\(>= len\)</span>，所以要取余 <span class="math inline">\((i+j) \mod len\)</span> 。<p>每次旋转更新最大值，时间复杂度为 <span class="math inline">\(O(N^2)\)</span> 。<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre><td class=code><pre><span class=line><span class=comment>// BF time: O(n^2) space: O(1)</span></span><br><span class=line>   <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">maxRotateFunction</span><span class=params>(<span class=type>int</span>[] nums)</span> {</span><br><span class=line>       <span class=type>int</span> <span class=variable>len</span> <span class=operator>=</span> nums.length;</span><br><span class=line>       <span class=keyword>if</span> (len <= <span class=number>1</span>) {</span><br><span class=line>           <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>       }</span><br><span class=line></span><br><span class=line>       <span class=type>int</span> <span class=variable>ans</span> <span class=operator>=</span> Integer.MIN_VALUE;</span><br><span class=line>       <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < len; i++) {</span><br><span class=line>           <span class=type>int</span> <span class=variable>sum</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>           <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>j</span> <span class=operator>=</span> <span class=number>0</span>; j < len; j++) {</span><br><span class=line>               sum += j * nums[(i + j) % len];</span><br><span class=line>           }</span><br><span class=line></span><br><span class=line>           ans = Math.max(ans, sum);</span><br><span class=line>       }</span><br><span class=line></span><br><span class=line>       <span class=keyword>return</span> ans;</span><br><span class=line>   }</span><br></pre></table></figure><h3 id=复杂度分析>复杂度分析：</h3><ul><li><p>时间复杂度：<span class="math inline">\(O(N^2)\)</span> ，其中 <span class="math inline">\(N\)</span> 是数组 <span class="math inline">\(\textit{nums}\)</span> 的长度。<li><p>空间复杂度：<span class="math inline">\(O(1)\)</span> 。</ul><h2 id=方法二-动态规划>方法二： 动态规划</h2><p><strong>思路与算法：</strong><p>方法一会<strong>超时</strong>，其实观察旋转数组的变化：<p><span class="math display">\[ F(0) = 0 \times nums[0] + 1 \times nums[1] + \ldots + (n - 1) \times nums[n-1] \]</span><p><span class="math display">\[ F(1) = 1 \times nums[0] + 2 \times nums[1] + \ldots + 0 \times nums[n-1] = F(0) + \sum_{i=0}^{n-1}nums[i] - n \times nums[n-1] \]</span><p>我们很容易发现相邻旋转的递推关系：<p><span class="math display">\[ F(k+1) = F(k) + \sum_{i=0}^{n-1}nums[i] - n \times nums[n-k], 0 \le k \lt n \]</span><p>从<span class="math inline">\(F(0)\)</span>出发，迭代计算出不同的<span class="math inline">\(F(k)\)</span>，并求出最大值。<p>很容易使用<strong>DP</strong>写出如下代码：<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line><span class=comment>// DP time: O(n) space: O(n)</span></span><br><span class=line><span class=keyword>public</span> <span class=type>int</span> <span class="title function_">maxRotateFunction_dp</span><span class=params>(<span class=type>int</span>[] nums)</span> {</span><br><span class=line>    <span class=type>int</span> <span class=variable>len</span> <span class=operator>=</span> nums.length;</span><br><span class=line>    <span class=keyword>if</span> (len <= <span class=number>1</span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=type>int</span>[] dp = <span class=keyword>new</span> <span class="title class_">int</span>[len];</span><br><span class=line>    <span class=type>int</span> <span class=variable>sum</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < len; i++) {</span><br><span class=line>        dp[<span class=number>0</span>] += i * nums[i];</span><br><span class=line>        sum += nums[i];</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=type>int</span> <span class=variable>ans</span> <span class=operator>=</span> dp[<span class=number>0</span>];</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>1</span>; i < len; i++) {</span><br><span class=line>        dp[i] = dp[i - <span class=number>1</span>] + sum - len * nums[(len - i) % len];</span><br><span class=line>        ans = Math.max(ans, dp[i]);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> ans;</span><br><span class=line>}</span><br></pre></table></figure><p>观察上述代码，我们发现<code>dp[]</code>数组只是记录数值，实际上可以将空间复杂度优化到<span class="math inline">\(O(1)\)</span>。<!--noindex--><div class=post-button><a class=btn href=/blog/leetcode-rotate-function/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/leetcode-merge-two-binary-trees/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc-3d-python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content=" | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/leetcode-merge-two-binary-trees/ itemprop=url>[LeetCode][617. Merge Two Binary Trees] 4 Approaches: Recursion, Iteration, BFS and DFS</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2022-04-12 06:55:26" datetime=2022-04-12T06:55:26+08:00>2022-04-12</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-05-03 16:21:55" datetime=2025-05-03T16:21:55+08:00 itemprop=dateModified>2025-05-03</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Leetcode/ itemprop=url rel=index><span itemprop=name>Leetcode</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/leetcode-merge-two-binary-trees/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/leetcode-merge-two-binary-trees/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/leetcode-merge-two-binary-trees/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>6.4k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>6 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p>This article is the solution <a href=https://leetcode.com/problems/merge-two-binary-trees/solutions/1860049/4-approaches-recursion-iteration-bfs-and-dfs/ rel=noopener target=_blank>4 Approaches: Recursion, Iteration, BFS and DFS</a> of Problem <a href=https://leetcode.com/problems/merge-two-binary-trees rel=noopener target=_blank>617. Merge Two Binary Trees</a> .<p>Here are <strong>4</strong> approaches to solve this problem in Java: <strong>Recursion</strong>, <strong>Iteration</strong>, <strong>BFS</strong> and <strong>DFS</strong>.<h2 id=recursion>Recursion</h2><h3 id=method-1-new-tree>Method 1: New Tree</h3><p>We can create a new <strong>Tree</strong>, each <span class="math inline">\(\texttt{TreeNode}\)</span> value is sum of two nodes.<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>static</span> TreeNode <span class="title function_">mergeTrees</span><span class=params>(TreeNode root1, TreeNode root2)</span> {</span><br><span class=line>    <span class=keyword>if</span> (root1 == <span class=literal>null</span>) {</span><br><span class=line>        <span class=keyword>return</span> root2;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>if</span> (root2 == <span class=literal>null</span>) {</span><br><span class=line>        <span class=keyword>return</span> root1;</span><br><span class=line>    }</span><br><span class=line>    <span class=type>TreeNode</span> <span class=variable>merged</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">TreeNode</span>(root1.val + root2.val);</span><br><span class=line>    merged.left = mergeTrees(root1.left, root2.left);</span><br><span class=line>    merged.right = mergeTrees(root1.right, root2.right);</span><br><span class=line>    <span class=keyword>return</span> merged;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=analysis>Analysis</h3><ul><li><strong>Time Complexity</strong>: <span class="math inline">\(O(min(m, n))\)</span><li><strong>Space Complexity</strong>: <span class="math inline">\(O(min(m, n))\)</span></ul><h3 id=method-2>Method 2</h3><p>Traverse both the given trees in a <strong>PreOrder</strong> style.<p>At every step, check if the current node exists for both the trees. If one of these children happens to be null, we return the child of the other tree to be added as a child subtree to the calling parent node in the first tree.<p>We can add the values in the current nodes of both the trees and update the value in the current node of the first tree to reflect this sum obtained.<p>Then we call the <span class="math inline">\(\texttt{mergeTrees()}\)</span> with the left children and then with the right children of the current nodes of the two trees.<p>At the end, the first tree will represent the required resultant merged binary tree.<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>static</span> TreeNode <span class="title function_">mergeTrees_rec</span><span class=params>(TreeNode root1, TreeNode root2)</span> {</span><br><span class=line>    <span class=keyword>if</span> (root1 == <span class=literal>null</span>) {</span><br><span class=line>        <span class=keyword>return</span> root2;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>if</span> (root2 == <span class=literal>null</span>) {</span><br><span class=line>        <span class=keyword>return</span> root1;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>if</span> (root1 != <span class=literal>null</span>) {</span><br><span class=line>        root1.val += root2.val;</span><br><span class=line>        root1.left = mergeTrees_rec(root1.left, root2.left);</span><br><span class=line>        root1.right = mergeTrees_rec(root1.right, root2.right);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> root1;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=analysis-1>Analysis</h3><ul><li><strong>Time Complexity</strong>: <span class="math inline">\(O(min(m, n))\)</span><li><strong>Space Complexity</strong>: <span class="math inline">\(O(min(m, n))\)</span></ul><!--noindex--><div class=post-button><a class=btn href=/blog/leetcode-merge-two-binary-trees/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/topological-sorting/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc-3d-python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content=" | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/topological-sorting/ itemprop=url>拓扑排序(Topological Sorting)</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2022-04-09 23:37:49" datetime=2022-04-09T23:37:49+08:00>2022-04-09</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-05-03 16:31:24" datetime=2025-05-03T16:31:24+08:00 itemprop=dateModified>2025-05-03</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Data-Structures-and-Algorithms/ itemprop=url rel=index><span itemprop=name>Data Structures and Algorithms</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/topological-sorting/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/topological-sorting/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/topological-sorting/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>857</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>1 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p><a href=https://leetcode.cn/problems/course-schedule/ rel=noopener target=_blank>207. 课程表</a><p>代码如下所示：<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">canFinish</span><span class=params>(<span class=type>int</span> numCourses, <span class=type>int</span>[][] prerequisites)</span> {</span><br><span class=line>    <span class=keyword>if</span> (prerequisites == <span class=literal>null</span> || prerequisites.length == <span class=number>0</span> || prerequisites[<span class=number>0</span>].length == <span class=number>0</span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>true</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=type>int</span>[] indegree = <span class=keyword>new</span> <span class="title class_">int</span>[numCourses];</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span>[] pre : prerequisites) {</span><br><span class=line>        indegree[pre[<span class=number>0</span>]]++;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    Queue&LTInteger> queue = <span class=keyword>new</span> <span class="title class_">LinkedList</span><>();</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < numCourses; i++) {</span><br><span class=line>        <span class=keyword>if</span> (indegree[i] == <span class=number>0</span>) {</span><br><span class=line>            queue.offer(i);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>while</span> (!queue.isEmpty()) {</span><br><span class=line>        <span class=type>Integer</span> <span class=variable>currId</span> <span class=operator>=</span> queue.poll();</span><br><span class=line>        numCourses--;</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span>[] pre : prerequisites) {</span><br><span class=line>            <span class=keyword>if</span> (pre[<span class=number>1</span>] == currId) {</span><br><span class=line>                indegree[pre[<span class=number>0</span>]]--;</span><br><span class=line>                <span class=keyword>if</span> (indegree[pre[<span class=number>0</span>]] == <span class=number>0</span>) {</span><br><span class=line>                    queue.offer(pre[<span class=number>0</span>]);</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> numCourses == <span class=number>0</span>;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=复杂度分析>复杂度分析</h3><ul><li>时间复杂度：<span class="math inline">\(O(V + E)\)</span> ，其中 <span class="math inline">\(n\)</span> 为字符串长度。<li>空间复杂度：<span class="math inline">\(O(V)\)</span> 。哈希表和字符串均需要存储 <span class="math inline">\(n\)</span> 个元素。</ul><h2 id=参考资料>参考资料</h2><ol type=1><li><a href=https://www.geeksforgeeks.org/topological-sorting/ rel=noopener target=_blank>Topological Sorting</a><li><a href=https://oi-wiki.org/graph/topo/ rel=noopener target=_blank>拓扑排序</a><li><a href=https://www.cs.usfca.edu/~galles/visualization/TopoSortIndegree.html rel=noopener target=_blank>Topological Sort (Indegree)</a><li><a href=https://www.cs.usfca.edu/~galles/visualization/TopoSortDFS.html rel=noopener target=_blank>Topological Sort (DFS)</a></ol></div><footer class=post-footer><div class=post-eof></div></footer></article></div><nav class=pagination><a class="extend prev" aria-label=上一页 href=/page/18/ rel=prev title=上一页><i class="fa fa-angle-left"></i></a><a class=page-number href=/>1</a><span class=space>…</span><a class=page-number href=/page/18/>18</a><span class="page-number current">19</span><a class=page-number href=/page/20/>20</a><span class=space>…</span><a class=page-number href=/page/70/>70</a><a class="extend next" aria-label=下一页 href=/page/20/ rel=next title=下一页><i class="fa fa-angle-right"></i></a></nav></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2013 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Long Luo</span></div><div class=wordcount><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-chart-line"></i> </span> <span title=站点总字数>1.6m</span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span> <span title=站点阅读时长>24:53</span> </span></div><div class=busuanzi-count><span class=post-meta-item id=busuanzi_container_site_uv> <span class=post-meta-item-icon> <i class="fa fa-user"></i> </span> <span class=site-uv title=总访客量> <span id=busuanzi_value_site_uv></span> </span> </span><span class=post-meta-item id=busuanzi_container_site_pv> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=site-pv title=总访问量> <span id=busuanzi_value_site_pv></span> </span> </span></div><div class=powered-by>由 <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/pisces/ rel=noopener target=_blank>NexT.Pisces</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><a class="book-mark-link book-mark-link-fixed" role=button></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script class=next-config data-name=waline type=application/json>{"lang":"zh-CN","enable":true,"serverURL":"https://waline.longluo.me/","cssUrl":"https://unpkg.com/@waline/client@v3/dist/waline.css","commentCount":true,"pageview":true,"libUrl":"https://unpkg.com/@waline/client@v3/dist/waline.umd.js","locale":{"placeholder":"欢迎大家的留言！(留言只需要填昵称即可，但填了email的话就可以收到博主的回复通知了！) Welcome to comment!"},"emoji":["https://unpkg.com/@waline/emojis@1.1.0/qq"],"meta":["nick","mail","link"],"requiredMeta":[["nick"]],"wordLimit":0,"pageSize":10,"el":"#waline","comment":true,"path":"/page/19/"}</script><link href=https://unpkg.com/@waline/client@v3/dist/waline.css rel=stylesheet><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});</script>