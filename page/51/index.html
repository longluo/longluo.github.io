<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta content=#222 name=theme-color><meta content="Hexo 7.1.1" name=generator><link href=https://fonts.googleapis.com rel=preconnect><link href=https://cdnjs.cloudflare.com rel=preconnect><link href=https://www.longluo.me/assets/logo/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://www.longluo.me/assets/logo/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://www.longluo.me/assets/logo/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=n6mekvZa-QaR3EnDD-CzJymq7mGubpU7rvoGpKROHLE name=google-site-verification><meta content=6BFBD4DDDB3B6F4FDD26CF82BADDB931 name=msvalidate.01><meta content=a2ab49d952ea45f5 name=yandex-verification><meta content=www.longluo.me name=baidu-site-verification><link href=/css/main.css rel=stylesheet><link as=style href=https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext onload=this.rel='stylesheet' rel=preload><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"www.longluo.me","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":5,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/config.min.js></script><meta content="A Curious Engineer" name=description><meta content=website property=og:type><meta content="Long Luo's Life Notes" property=og:title><meta content=https://www.longluo.me/page/51/index.html property=og:url><meta content="Long Luo's Life Notes" property=og:site_name><meta content="A Curious Engineer" property=og:description><meta content=zh_CN property=og:locale><meta content="Long Luo" property=article:author><meta content="longluo, Tech, Tech Blog, 技术博客, Personal Blog, 个人博客, Android, 安卓博客, 原创博客, Software Engineer, 软件工程师, Program, 编程, 程序员, 码农, Java, C, C++, Data Structures, 数据结构, Algorithm, 算法, Life" property=article:tag><meta content=summary name=twitter:card><link href=https://www.longluo.me/page/51/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/51/index.html","title":""}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Long Luo's Life Notes</title><script async src=https://www.googletagmanager.com/gtag/js?id=UA-46213499-2></script><script class=next-config data-name=google_analytics type=application/json>{"tracking_id":"UA-46213499-2","only_pageview":false,"measure_protocol_api_secret":null}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/third-party/analytics/google-analytics.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/third-party/analytics/baidu-analytics.min.js></script><script async src=https://hm.baidu.com/hm.js?a75fb5d0c0ef1e36c34b7f52bb7c48be></script><script async src=https://assets.growingio.com/2.1/gio.js></script><script class=next-config data-name=growingio_analytics type=application/json>"bc65befc551b6d70"</script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/third-party/analytics/growingio.min.js></script><script>(function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "gz2vdkhgvh");</script><script class=next-config data-name=matomo type=application/json>{"enable":true,"server_url":"https://longluo.matomo.cloud/","site_id":1}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/third-party/analytics/matomo.min.js></script><script async data-host-url=longluo.me data-website-id=2a6d2bf9-2adf-474b-a292-84ca30206507 defer src=https://analytics.us.umami.is/script.js></script><script data-domain=longluo.me defer src=https://plausible.io/js/script.js></script><link href=https://waline.longluo.me/ rel=dns-prefetch><noscript><link href=/css/noscript.css rel=stylesheet></noscript><style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style><link title="Long Luo's Life Notes" href=/atom.xml rel=alternate type=application/atom+xml><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <h1 class=site-title>Long Luo's Life Notes</h1> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>每一天都是奇迹</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-works"><a href=/works rel=section><i class="fa fa-code fa-fw"></i>works</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt="Long Luo" class=site-author-image itemprop=image src=https://www.longluo.me/assets/avatar/sinc_3d_python.png><p class=site-author-name itemprop=name>Long Luo<div class=site-description itemprop=description>A Curious Engineer</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>338</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>24</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>324</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/longluo" href=https://github.com/longluo target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="ZhiHu → http://www.zhihu.com/people/longluo" href=http://www.zhihu.com/people/longluo target=_blank><i class="fab fa-quora fa-fw"></i>ZhiHu</a> </span><span class=links-of-author-item> <a rel="noopener me" title="LinkedIn → https://www.linkedin.com/in/longluo/" href=https://www.linkedin.com/in/longluo/ target=_blank><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a> </span><span class=links-of-author-item> <a rel="noopener me" title="E-Mail → mailto:luolong0226@163.com" href=mailto:luolong0226@163.com target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div><div class="sidebar-inner sidebar-blogroll"><div class="links-of-blogroll animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i> 链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://blog.csdn.net/tcpipstack rel=noopener target=_blank title=http://blog.csdn.net/tcpipstack>My CSDN</a><li class=links-of-blogroll-item><a href=https://www.ruanyifeng.com/home.html rel=noopener target=_blank title=https://www.ruanyifeng.com/home.html>阮一峰老师</a><li class=links-of-blogroll-item><a href=https://hutusi.com/ rel=noopener target=_blank title=https://hutusi.com/>胡涂说</a><li class=links-of-blogroll-item><a href=https://www.qtmuniao.com/ rel=noopener target=_blank title=https://www.qtmuniao.com/>木鸟杂记</a></ul></div></div></aside></div><div class="main-inner index posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/2016/08/08/top-9-questions-about-java-maps/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc_3d_python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/2016/08/08/top-9-questions-about-java-maps/ itemprop=url>Top 9 Questions About Java Maps</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2016-08-08 11:18:22" datetime=2016-08-08T11:18:22+08:00>2016-08-08</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-11-14 22:24:40" datetime=2023-11-14T22:24:40+08:00 itemprop=dateModified>2023-11-14</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Java/ itemprop=url rel=index><span itemprop=name>Java</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/2016/08/08/top-9-questions-about-java-maps/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/2016/08/08/top-9-questions-about-java-maps/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/2016/08/08/top-9-questions-about-java-maps/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>6.3k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>6 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p>In general, Map is a data structure consisting of a set of key-value pairs, and each key can only appears once in the map. This post summarizes Top 9 FAQ of how to use Java Map and its implemented classes. For sake of simplicity, I will use generics in examples. Therefore, I will just write Map instead of specific Map. But you can always assume that both the K and V are comparable, which means K extends Comparable and V extends Comparable.<h1 id=convert-a-map-to-list>1. Convert a Map to List</h1><p>In Java, Map interface provides three collection views: key set, value set, and keyvalue set. All of them can be converted to List by using a constructor or addAll() method. The following snippet of code shows how to construct an ArrayList from a map.<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=comment>// key list</span></span><br><span class=line><span class=type>List</span> <span class=variable>keyList</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ArrayList</span>(map.keySet());</span><br><span class=line><span class=comment>// value list</span></span><br><span class=line><span class=type>List</span> <span class=variable>valueList</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ArrayList</span>(map.valueSet());</span><br><span class=line><span class=comment>// key value list</span></span><br><span class=line><span class=type>List</span> <span class=variable>entryList</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ArrayList</span>(map.entrySet());</span><br></pre></table></figure><h1 id=iterate-over-each-entry-in-a-map>2. iterate over each entry in a map</h1><p>Iterating over every pair of key-value is the most basic operation to traverse a map. In Java, such pair is stored in the map entry called Map.Entry.<h1 id=sort-a-map-on-the-keys>3. SORT A MAP ON THE KEYS</h1><p>Map.entrySet() returns a key-value set, therefore the most efficient way of going through every entry of a map is<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=keyword>for</span> (Entry entry:map.entrySet()) {</span><br><span class=line>    <span class=comment>// get key</span></span><br><span class=line>    <span class=type>K</span> <span class=variable>key</span> <span class=operator>=</span> entry.getKey();</span><br><span class=line>    <span class=comment>// get value</span></span><br><span class=line>    <span class=type>V</span> <span class=variable>value</span> <span class=operator>=</span> entry.getValue();</span><br><span class=line>}</span><br></pre></table></figure><p>Iterator can also be used, especially before JDK 1.5<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line><span class=type>Iterator</span> <span class=variable>itr</span> <span class=operator>=</span> map.entrySet().iterator();</span><br><span class=line><span class=keyword>while</span>(itr.hasNext ( ) ) {</span><br><span class=line>Entry <span class=type>ent</span> <span class=variable>ry</span> <span class=operator>=</span> i t r . next ( ) ;</span><br><span class=line>/ / g e t k ey</span><br><span class=line><span class=type>K</span> <span class=variable>key</span> <span class=operator>=</span> ent ry . getKey ( ) ;</span><br><span class=line>/ / g e t v a l u e</span><br><span class=line><span class=type>V</span> <span class=variable>value</span> <span class=operator>=</span> ent ry . getValue ( ) ;</span><br><span class=line>}</span><br></pre></table></figure><p>60.3 sort a map on the keys Sorting a map on the keys is another frequent operation. One way is to put Map.Entry into a list, and sort it using a comparator that sorts the value. Li s t l i s t = new Ar rayLi s t (map. ent rySe t ( ) ) ; Co l l e c t i ons . s o r t ( l i s t , new Comparator ( ) { <span class=citation data-cites=Override>@Override</span> public int compare ( Entry e1 , Entry e2 ) { return e1 . getKey ( ) . compareTo ( e2 . getKey ( ) ) ; } });<p>The other way is to use SortedMap, which further provides a total ordering on its keys. Therefore all keys must either implement Comparable or be accepted by the comparator.<h2 id=sort-a-map-on-the-values>4. SORT A MAP ON THE VALUES</h2><p>One implementing class of SortedMap is TreeMap. Its constructor can accept a comparator. The following code shows how to transform a general map to a sorted map.<p>SortedMap sortedMap = new TreeMap (new Comparator ( ) { <span class=citation data-cites=Override>@Override</span> public int compare (K k1 , K k2 ) { return k1 . compareTo ( k2 ) ; } } ) ; sortedMap . putAll (map) ; 60.4 sort a map on the values Putting the map into a list and sorting it works on this case too, but we need to compare Entry.getValue() this time. The code below is almost same as before. Li s t l i s t = new Ar rayLi s t (map. ent rySe t ( ) ) ; Co l l e c t i ons . s o r t ( l i s t , new Comparator ( ) { <span class=citation data-cites=Override>@Override</span> public int compare ( Entry e1 , Entry e2 ) { return e1 . getValue ( ) . compareTo ( e2 . getValue ( ) ) ; } } ) ; We can still use a sorted map for this question, but only if the values are unique too. Under such condition, you can reverse the key=value pair to value=key. This solution has very strong limitation therefore is not really recommended by me. 60.5 initialize a static/immutable map When you expect a map to remain constant, it’s a good practice to copy it into an immutable map. Such defensive programming techniques will help you create not only safe for use but also safe for thread maps. 60.6. DIFFERENCE BETWEEN HASHMAP, TREEMAP, AND HASHTABLE 217 To initialize a static/immutable map, we can use a static initializer (like below). The problem of this code is that, although map is declared as static final, we can still operate it after initialization, like Test.map.put(3,“three”);. Therefore it is not really immutable. To create an immutable map using a static initializer, we need an extra anonymous class and copy it into a unmodifiable map at the last step of initialization. Please see the second piece of code. Then, an UnsupportedOperationException will be thrown if you run Test.map.put(3,“three”);. public c l a s s Tes t { pr ivate s t a t i c f ina l Map map; s t a t i c { map = new HashMap ( ) ; map. put ( 1 , ” one ” ) ; map. put ( 2 , ” two ” ) ; } } public c l a s s Tes t { pr ivate s t a t i c f ina l Map map; s t a t i c { Map aMap = new HashMap ( ) ; aMap. put ( 1 , ” one ” ) ; aMap. put ( 2 , ” two ” ) ; map = Co l l e c t i ons . unmodifiableMap (aMap) ; } } Guava libraries also support different ways of intilizaing a static and immutable collection. To learn more about the benefits of Guava’s immutable collection utilities, see Immutable Collections Explained in Guava User Guide. 60.6 difference between hashmap, treemap, and hashtable There are three main implementations of Map interface in Java: HashMap, TreeMap, and Hashtable. The most important differences include: The order of iteration. HashMap and HashTable make no guarantees as to the order of the map; in particular, they do not guarantee that the order 60.7. A MAP WITH REVERSE VIEW/LOOKUP 218 will remain constant over time. But TreeMap will iterate the whole entries according the “natural ordering” of the keys or by a comparator. key-value permission. HashMap allows null key and null values. HashTable does not allow null key or null values. If TreeMap uses natural ordering or its comparator does not allow null keys, an exception will be thrown. Synchronized. Only HashTable is synchronized, others are not. Therefore, “if a thread-safe implementation is not needed, it is recommended to use HashMap in place of HashTable.” A more complete comparison is | HashMap | HashTable | TreeMap i t e r a t i o n order | no | no | yes null key value | yes yes | yes yes | no yes synchronized | no | yes | no time performance | O( 1 ) | O( 1 ) | O( log n) implementation | buckets | buckets | red black t r e e Read more about HashMap vs. TreeMap vs. Hashtable vs. LinkedHashMap. 60.7 a map with reverse view/lookup Sometimes, we need a set of key-key pairs, which means the map’s values are unique as well as keys (one-to-one map). This constraint enables to create an “inverse lookup/view” of a map. So we can lookup a key by its value. Such data structure is called bidirectional map, which unfortunetely is not supported by JDK. 60.8 both apache common collections and guava provide implementation of bidirectional map, called bidimap and bimap, respectively. both enforce the restriction that there is a 1:1 relation between keys and values. 7. shallow copy of a map Most implementation of a map in java, if not all, provides a constructor of copy of another map. But the copy procedure is not synchronized. That means when 60.9. FOR THIS REASON, I WILL NOT EVEN TELL YOU HOW TO USE CLONE() METHOD TO COPY one thread copies a map, another one may modify it structurally. To prevent accidental unsynchronized copy, one should use Collections.synchronizedMap() in advance.<p>Map copiedMap = Co l l e c t i ons.synchronizedMap (map) ; Another interesting way of shallow copy is by using clone() method. However it is NOT even recommended by the designer of Java collection framework, Josh Bloch. In a conversation about “Copy constructor versus cloning“, he said I often provide a public clone method on concrete classes because people expect it.<p>It’s a shame that Cloneable is broken, but it happens. Cloneable is a weak spot, and I think people should be aware of its limitations.<p>60.9 for this reason, i will not even tell you how to use clone() method to copy a map. 8. create an empty map If the map is immutable, use map = Co l l e c t i ons . emptyMap ( ) ;<p>Otherwise, use whichever implementation. For example map = new HashMap ( ) ;<p>THE</div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/2016/08/07/top-10-questions-about-java-collections/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc_3d_python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/2016/08/07/top-10-questions-about-java-collections/ itemprop=url>关于Java Collections应知应会</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2016-08-07 22:56:28" datetime=2016-08-07T22:56:28+08:00>2016-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-11-14 22:24:40" datetime=2023-11-14T22:24:40+08:00 itemprop=dateModified>2023-11-14</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Java/ itemprop=url rel=index><span itemprop=name>Java</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/2016/08/07/top-10-questions-about-java-collections/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/2016/08/07/top-10-questions-about-java-collections/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/2016/08/07/top-10-questions-about-java-collections/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>4.4k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>4 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>翻译 By Long Luo</em></strong><p>下面这些问题<a href=http://www.stackoverflow.com rel=noopener target=_blank>Stackoverflow</a>上关于Java collections提问和讨论最多的问题。在你阅读这些问题之前，有必要先阅读下这篇文章<a href=http://www.longluo.me/blog/2016/08/08/The-Interface-and-Class-Hierarchy-Diagram-of-Java-Collections/>3分钟速读：图解Java Collections的接口以及类层级关系</a>。<h1 id=什么时候用linkedlist什么时候用arraylist>1. 什么时候用LinkedList？什么时候用ArrayList？</h1><p><strong><em>ArrayList</em></strong>本质上是一个数组。它的元素可以直接通过索引值直接访问。但是如果数组已经满了，那么需要重新分配一个更大的数组并且将全部的元素移动到新的数组需要花费<strong><em>O(n)</em></strong>的时间。当然从现有的数组中增加或者删除一个元素都需要移动现有的元素。这个可能是使用ArrayList中最大的不便之处。<p><strong><em>LinkedList</em></strong>是一个<strong>双端链表</strong>。正因为如此，如果要获取一个链表中间的元素，需要从链表的头部开始查找。另一方面，增加或者删除链表中的元素将会很快，因为只需要在本地修改即可。<p>下表总结了最快情况下的比较需要耗费时间：<table><thead><tr class=header><th style="text-align: left;">Method<th style="text-align: right;">Arraylist<th style="text-align: center;">LinkedList<tbody><tr class=odd><td style="text-align: left;">get(index)<td style="text-align: right;">O(1)<td style="text-align: center;">O(n)<tr class=even><td style="text-align: left;">add(E)<td style="text-align: right;">O(n)<td style="text-align: center;">O(1)<tr class=odd><td style="text-align: left;">add(E, index)<td style="text-align: right;">O(n)<td style="text-align: center;">O(n)<tr class=even><td style="text-align: left;">remove(index)<td style="text-align: right;">O(n)<td style="text-align: center;">O(n)<tr class=odd><td style="text-align: left;">Iterator.remove()<td style="text-align: right;">O(n)<td style="text-align: center;">O(1)<tr class=even><td style="text-align: left;">Iterator.add(E)<td style="text-align: right;">O(n)<td style="text-align: center;">O(1)</table><p>不管运行时间，当大型列表需要额外考虑内存占用。LinkedList每个node至少需要2个额外的指针用于连接前后2个node。而在ArrayList中只需要数组存储元素值即可。<h1 id=当遍历容器时高效等价于移除元素的操作>2. 当遍历容器时，高效等价于移除元素的操作？</h1><p>最正确的方式就是在遍历容器时用<code>Iterator.remove()</code>去修改一个容器，如下代码所示：<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line>Iterator&LTInteger> itr = list.iterator();</span><br><span class=line><span class=keyword>while</span>(itr.hasNext()) {</span><br><span class=line>   <span class=comment>// do something</span></span><br><span class=line>   itr.remove();</span><br><span class=line>}</span><br></pre></table></figure><p>另外一个非常高频的使用但是<strong><em>不正确</em></strong>的代码是这样的：<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=keyword>for</span>(Integer i: list) {</span><br><span class=line>  list.remove(i);</span><br><span class=line>}</span><br></pre></table></figure><p>运行上面的代码时你会得到一个<code>ConcurrentModificationException</code>。原因是因为一个迭代器自生成之后(在for循环中)，用于横贯这个列表。与此同时，这个列表同时也被<code>Iterator.remove()</code>修改了。在Java语言中，当一个线程在修改一个容器时而另外一个线程在遍历它是不允许的。<h1 id=如何将list转换成int>3. 如何将List转换成int[]？</h1><p>最快捷的方式可能是用Apache Commons Lang库中的<strong><em>ArrayUtils</em></strong>。<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=type>int</span>[] array = ArrayUtils.toPrimitive(list.toArray(<span class=keyword>new</span> <span class="title class_">Integer</span>[<span class=number>0</span>]));</span><br></pre></table></figure><p>在JDK中，没有快捷方式。请注意你不能使用<code>List.toArray()</code>，因为那会将列表转换成<code>Integer[]</code>。正确的方式应该是这样的：<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=type>int</span>[] array = <span class=keyword>new</span> <span class="title class_">int</span>[list.size()];</span><br><span class=line><span class=keyword>for</span>(<span class=type>int</span> i=<span class=number>0</span>; i < list.size(); i++) {</span><br><span class=line>  array[i] = list.get(i);</span><br><span class=line>}</span><br></pre></table></figure><!--noindex--><div class=post-button><a class=btn href=/blog/2016/08/07/top-10-questions-about-java-collections/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/2016/08/06/top-10-methods-for-java-arrays/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc_3d_python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/2016/08/06/top-10-methods-for-java-arrays/ itemprop=url>Java Array最重要的10个方法</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2016-08-06 22:26:58" datetime=2016-08-06T22:26:58+08:00>2016-08-06</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-11-14 22:24:40" datetime=2023-11-14T22:24:40+08:00 itemprop=dateModified>2023-11-14</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Java/ itemprop=url rel=index><span itemprop=name>Java</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/2016/08/06/top-10-methods-for-java-arrays/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/2016/08/06/top-10-methods-for-java-arrays/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/2016/08/06/top-10-methods-for-java-arrays/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>2.4k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>2 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p>本文将展示Java Array的最重要的10个方法：<h1 id=声明一个数组>0. 声明一个数组</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>String[] aArray = <span class=keyword>new</span> <span class="title class_">String</span>[<span class=number>5</span>];</span><br><span class=line>String[] bArray = {<span class=string>"a"</span>,<span class=string>"b"</span>,<span class=string>"c"</span>, <span class=string>"d"</span>, <span class=string>"e"</span>};</span><br><span class=line>String[] cArray = <span class=keyword>new</span> <span class="title class_">String</span>[]{<span class=string>"a"</span>,<span class=string>"b"</span>,<span class=string>"c"</span>,<span class=string>"d"</span>,<span class=string>"e"</span>};</span><br></pre></table></figure><h1 id=打印数组>1. 打印数组</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre><td class=code><pre><span class=line><span class=type>int</span>[] intArray = { <span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>, <span class=number>5</span> };</span><br><span class=line><span class=type>String</span> <span class=variable>intArrayString</span> <span class=operator>=</span> Arrays.toString(intArray);</span><br><span class=line> </span><br><span class=line><span class=comment>// print directly will print reference value</span></span><br><span class=line>System.out.println(intArray);</span><br><span class=line><span class=comment>// [I@7150bd4d</span></span><br><span class=line> </span><br><span class=line>System.out.println(intArrayString);</span><br><span class=line><span class=comment>// [1, 2, 3, 4, 5]</span></span><br></pre></table></figure><h1 id=从一个数组中创建一个arraylist>2. 从一个数组中创建一个ArrayList</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line>String[] stringArray = { <span class=string>"a"</span>, <span class=string>"b"</span>, <span class=string>"c"</span>, <span class=string>"d"</span>, <span class=string>"e"</span> };</span><br><span class=line>ArrayList&LTString> arrayList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&LTString>(Arrays.asList(stringArray));</span><br><span class=line>System.out.println(arrayList);</span><br><span class=line><span class=comment>// [a, b, c, d, e]</span></span><br></pre></table></figure><h1 id=判断数组中是否包含一个特定的值>3. 判断数组中是否包含一个特定的值</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line>String[] stringArray = { <span class=string>"a"</span>, <span class=string>"b"</span>, <span class=string>"c"</span>, <span class=string>"d"</span>, <span class=string>"e"</span> };</span><br><span class=line><span class=type>boolean</span> <span class=variable>b</span> <span class=operator>=</span> Arrays.asList(stringArray).contains(<span class=string>"a"</span>);</span><br><span class=line>System.out.println(b);</span><br><span class=line><span class=comment>// true</span></span><br></pre></table></figure><h1 id=连接2个数组>4. 连接2个数组</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=type>int</span>[] intArray = { <span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>, <span class=number>5</span> };</span><br><span class=line><span class=type>int</span>[] intArray2 = { <span class=number>6</span>, <span class=number>7</span>, <span class=number>8</span>, <span class=number>9</span>, <span class=number>10</span> };</span><br><span class=line><span class=comment>// Apache Commons Lang library</span></span><br><span class=line><span class=type>int</span>[] combinedIntArray = ArrayUtils.addAll(intArray, intArray2);</span><br></pre></table></figure><h1 id=声明一个inline数组>5. 声明一个inline数组</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>method(<span class=keyword>new</span> <span class="title class_">String</span>[]{<span class=string>"a"</span>, <span class=string>"b"</span>, <span class=string>"c"</span>, <span class=string>"d"</span>, <span class=string>"e"</span>});</span><br></pre></table></figure><h1 id=将一个数组中元素变成一个字符串>6. 将一个数组中元素变成一个字符串</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=comment>// containing the provided list of elements</span></span><br><span class=line><span class=comment>// Apache common lang</span></span><br><span class=line><span class=type>String</span> <span class=variable>j</span> <span class=operator>=</span> StringUtils.join(<span class=keyword>new</span> <span class="title class_">String</span>[] { <span class=string>"a"</span>, <span class=string>"b"</span>, <span class=string>"c"</span> }, <span class=string>", "</span>);</span><br><span class=line>System.out.println(j);</span><br><span class=line><span class=comment>// a, b, c</span></span><br></pre></table></figure><!--noindex--><div class=post-button><a class=btn href=/blog/2016/08/06/top-10-methods-for-java-arrays/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/2016/08/05/top-10-questions-of-java-strings/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc_3d_python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/2016/08/05/top-10-questions-of-java-strings/ itemprop=url>关于Java字符串(String)10个最常见问题</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2016-08-05 09:49:42" datetime=2016-08-05T09:49:42+08:00>2016-08-05</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-11-14 22:24:40" datetime=2023-11-14T22:24:40+08:00 itemprop=dateModified>2023-11-14</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Java/ itemprop=url rel=index><span itemprop=name>Java</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/2016/08/05/top-10-questions-of-java-strings/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/2016/08/05/top-10-questions-of-java-strings/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/2016/08/05/top-10-questions-of-java-strings/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>1.6k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>1 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p>Java语言中，String一直很基础，但很多人都很多概念还是很模糊。这里我们选取了网络上最常见的10个问题，希望通过这篇文章让大家对Java String有更深刻的认识。<h1 id=如何对字符串进行比较用-还是equals>1. 如何对字符串进行比较？用“==” 还是<code>equals()</code>？</h1><p>简单来说，如果<strong>引用是否相同</strong>那么使用<code>==</code>， 判断<strong><em>值是否相等</em></strong>则用<code>equals()</code>。除非你想判断2个字符串是否是同一对象，否则你都应该使用<code>equals()</code>。<h1 id=为什么在安全敏感信息场合应该用char而不是string>2. 为什么在安全敏感信息场合应该用char[]而不是string？</h1><p>String具有不可变的特性，当字符串一旦被创建，那么知道垃圾收集器处理之前他们都是不可变的。如果使用数组，那么你可以明确地改变其内部单元数据。因此，安全敏感的信息例如密码不应该在系统中任何时候都存在。<h1 id=我们可以在switch语句中使用string吗>3. 我们可以在switch语句中使用string吗？</h1><p>是的，在Java 7中可以！JDK7中，我们可以在<code>switch</code>中使用string。但是之前的Java版本是不可以的。<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre><td class=code><pre><span class=line><span class=comment>// java 7 only!</span></span><br><span class=line><span class=keyword>switch</span>(str.toLowerCase()){</span><br><span class=line>	<span class=keyword>case</span> <span class=string>"a"</span>:</span><br><span class=line>		value = <span class=number>1</span>;</span><br><span class=line>		<span class=keyword>break</span>;</span><br><span class=line></span><br><span class=line>	<span class=keyword>case</span> <span class=string>"b"</span>:</span><br><span class=line>		value = <span class=number>2</span> ;</span><br><span class=line>		<span class=keyword>break</span>;</span><br><span class=line>	}</span><br></pre></table></figure><h1 id=如何将字符转成int类型>4. 如何将字符转成Int类型？</h1><figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=type>int</span> <span class=variable>n</span> <span class=operator>=</span> Integer.parseInt(<span class=string>"10"</span>);</span><br></pre></table></figure><p>就是这样简单！<h1 id=如何用白色空格字符分离一个字符串>5. 如何用白色空格字符分离一个字符串？</h1><p>可以使用<strong><em>正则表达式</em></strong>分离字符串。““表示白色空格字符比如” “,”“。<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>String [] strArray = aString.split(<span class=string>"\\s+"</span>);</span><br></pre></table></figure><h1 id=substring这个方法起什么作用>6. <code>substring()</code>这个方法起什么作用？</h1><p>在JDK6中，<code>substring()</code>方法并不会创建一个新的字符数组，而是给现存的字符串一个窗口用于表示当前字符串。如果想用一个新的字符数组来表示新的字符串，你可以加一个空支付串来实现，如下所示：<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>str.substring(m, n) + <span class=string>""</span></span><br></pre></table></figure><p>使用上述方法，会创建一个新的字符数组来表示新的字符串。有时候可以让你的代码更快，因为垃圾收集器会收集一些没有使用的大字符串但子字符串确实保留的。<p>JDK7中，<code>substring()</code>会创建一个新的字符数组，而不是使用现在的这个。<!--noindex--><div class=post-button><a class=btn href=/blog/2016/08/05/top-10-questions-of-java-strings/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://www.longluo.me/blog/2016/08/03/android-custom-view-create-an-analog-clock/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://www.longluo.me/assets/avatar/sinc_3d_python.png itemprop=image> <meta content="Long Luo" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="Long Luo's Life Notes" itemprop=name> <meta content="A Curious Engineer" itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | Long Luo's Life Notes" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/blog/2016/08/03/android-custom-view-create-an-analog-clock/ itemprop=url>Android自定义View：如何实现一个模拟时钟？</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2016-08-03 22:35:45" datetime=2016-08-03T22:35:45+08:00>2016-08-03</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-11-14 22:24:40" datetime=2023-11-14T22:24:40+08:00 itemprop=dateModified>2023-11-14</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Android/ itemprop=url rel=index><span itemprop=name>Android</span></a> </span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-comment"></i> </span> <span class=post-meta-item-text>Waline：</span> <a href=/blog/2016/08/03/android-custom-view-create-an-analog-clock/#waline itemprop=discussionUrl title=waline> <span class="post-comments-count waline-comment-count" data-path=/blog/2016/08/03/android-custom-view-create-an-analog-clock/ itemprop=commentCount></span> </a> </span><span class=post-meta-item title=阅读次数> <span class=post-meta-item-icon> <i class="far fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span class=waline-pageview-count data-path=/blog/2016/08/03/android-custom-view-create-an-analog-clock/></span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>2.3k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>2 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><p><strong><em>By Long Luo</em></strong><p><strong>Android中自定义控件</strong>一直都是Android开发中的一个难点。<p>最近看大牛 <a href=http://weibo.com/eclipsexu?s=6cm7D0 rel=noopener target=_blank><span class=citation data-cites=Tomcat的猫>@Tomcat的猫</span></a> 写的 <a href=http://blog.csdn.net/eclipsexys rel=noopener target=_blank>《Android群英传》</a> 里面的第六章<strong>Android绘图机制及处理技巧</strong>，里面通过<code>Canvas</code>实现了一个如下所示的仪表盘：<figure><img alt=仪表盘 src=http://qrn8zhq7m.bkt.clouddn.com/clock_still.png><figcaption aria-hidden=true>仪表盘</figcaption></figure><p>在书中详细描述了如何实现这个仪表盘，这里就不赘述了，可以参考其 <a href=https://github.com/xuyisheng/AndroidHeroes/tree/master/6.%E7%BB%98%E5%9B%BE/MyApplication/app/src/main/java/com/yishengxu/myapplication rel=noopener target=_blank>具体实现代码</a> 。<p>但是这个表盘的指针是<strong>静止不动</strong>的，如果我们能让这个表盘的指针展示当前时间，随着时间而转动，那么我们就可以一款模拟时钟了。<p>那么，问题就来了：<p><strong><em>如何才能让时钟的指针动起来呢？</em></strong><p>这个问题，我们可以考虑分为2步去实现，第一步先绘制出当前的时间，第二部再让指针动起来。通过这样我们就可以实现一款<strong>模拟时钟</strong>。<h1 id=一绘制当前时间>一、绘制当前时间</h1><h2 id=获取当前时间>1.1 获取当前时间</h2><p>要绘制当前时间，我们要先获取当前时间。<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>mTime.setToNow();</span><br></pre></table></figure><h2 id=获取指针角度>1.2 获取指针角度</h2><p>当前时间可分为<strong><em>时，分，秒</em></strong>。<p>我们最终要获取的是时分秒3个指针对应的<strong>精确角度</strong>。<blockquote><p>秒针角度：最简单，直接乘以6即可获得。 分针角度：当前分钟 * 6 + 6 * 秒 / 60F 时针角度：(当前小时 % 12) * 30 + 30 * 当前分钟角度 / 360F;</blockquote><h2 id=绘制指针>1.3 绘制指针</h2><p>获取到指针角度之后，接下来就是在表盘绘制指针了。这里我们要利用<code>canvas.rotate()</code>这个方法来实现绘制指针，具体实现代码如下所示：<figure class="highlight java"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br></pre><td class=code><pre><span class=line><span class=keyword>private</span> <span class=keyword>void</span> <span class="title function_">drawTime</span><span class=params>(Canvas canvas)</span> {</span><br><span class=line>    <span class=comment>// 当前时间</span></span><br><span class=line>    mTime.setToNow();</span><br><span class=line></span><br><span class=line>    <span class=comment>// 当前时间对应的角度</span></span><br><span class=line>    <span class=type>float</span> <span class=variable>secRot</span> <span class=operator>=</span> mTime.second * <span class=number>6</span>;</span><br><span class=line>    <span class=type>float</span> <span class=variable>minRot</span> <span class=operator>=</span> mTime.minute * <span class=number>6</span> + <span class=number>6</span> * mTime.second / <span class=number>60F</span>;</span><br><span class=line>    <span class=type>float</span> <span class=variable>hrRot</span> <span class=operator>=</span> (mTime.hour % <span class=number>12</span>) * <span class=number>30</span> + <span class=number>30</span> * minRot / <span class=number>360F</span>;</span><br><span class=line></span><br><span class=line>    Log.d(TAG, <span class=string>"hrRot="</span> + hrRot + <span class=string>",minRot="</span> + minRot + <span class=string>",secRot="</span> + secRot);</span><br><span class=line></span><br><span class=line>    <span class=comment>// 画指针</span></span><br><span class=line>    <span class=type>Paint</span> <span class=variable>paintHour</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Paint</span>();</span><br><span class=line>    paintHour.setStrokeWidth(<span class=number>20</span>);</span><br><span class=line>    <span class=type>Paint</span> <span class=variable>paintMinute</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Paint</span>();</span><br><span class=line>    paintMinute.setStrokeWidth(<span class=number>10</span>);</span><br><span class=line>    <span class=type>Paint</span> <span class=variable>paintSecond</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Paint</span>();</span><br><span class=line>    paintSecond.setStrokeWidth(<span class=number>5</span>);</span><br><span class=line></span><br><span class=line>    canvas.save();</span><br><span class=line></span><br><span class=line>    <span class=comment>// 时针</span></span><br><span class=line>    canvas.rotate(hrRot, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>);</span><br><span class=line>    canvas.drawLine(mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span> - mWidth / <span class=number>2</span> + <span class=number>320</span>,</span><br><span class=line>            paintHour);</span><br><span class=line>    canvas.rotate(-hrRot, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>);</span><br><span class=line></span><br><span class=line>    <span class=comment>// 分针</span></span><br><span class=line>    canvas.rotate(minRot, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>);</span><br><span class=line>    canvas.drawLine(mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span> - mWidth / <span class=number>2</span> + <span class=number>230</span>,</span><br><span class=line>            paintMinute);</span><br><span class=line>    canvas.rotate(-minRot, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>);</span><br><span class=line></span><br><span class=line>    <span class=comment>// 秒针</span></span><br><span class=line>    canvas.rotate(secRot, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>);</span><br><span class=line>    canvas.drawLine(mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span> - mWidth / <span class=number>2</span> + <span class=number>150</span>,</span><br><span class=line>            paintSecond);</span><br><span class=line>    canvas.rotate(-secRot, mWidth / <span class=number>2</span>, mHeight / <span class=number>2</span>);</span><br><span class=line></span><br><span class=line>    canvas.restore();</span><br><span class=line>}</span><br></pre></table></figure><!--noindex--><div class=post-button><a class=btn href=/blog/2016/08/03/android-custom-view-create-an-analog-clock/#more rel=contents> 阅读全文 » </a></div><!--/noindex--></div><footer class=post-footer><div class=post-eof></div></footer></article></div><nav class=pagination><a class="extend prev" aria-label=上一页 href=/page/50/ rel=prev title=上一页><i class="fa fa-angle-left"></i></a><a class=page-number href=/>1</a><span class=space>…</span><a class=page-number href=/page/50/>50</a><span class="page-number current">51</span><a class=page-number href=/page/52/>52</a><span class=space>…</span><a class=page-number href=/page/68/>68</a><a class="extend next" aria-label=下一页 href=/page/52/ rel=next title=下一页><i class="fa fa-angle-right"></i></a></nav></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2013 – <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Long Luo</span></div><div class=wordcount><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-chart-line"></i> </span> <span title=站点总字数>1.5m</span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span> <span title=站点阅读时长>22:37</span> </span></div><div class=busuanzi-count><span class=post-meta-item id=busuanzi_container_site_uv> <span class=post-meta-item-icon> <i class="fa fa-user"></i> </span> <span class=site-uv title=总访客量> <span id=busuanzi_value_site_uv></span> </span> </span><span class=post-meta-item id=busuanzi_container_site_pv> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=site-pv title=总访问量> <span id=busuanzi_value_site_pv></span> </span> </span></div><div class=powered-by>由 <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/pisces/ rel=noopener target=_blank>NexT.Pisces</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><a class="book-mark-link book-mark-link-fixed" role=button></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/comments.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/utils.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/motion.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/sidebar.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/next-boot.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/bookmark.min.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/third-party/search/local-search.min.js></script><script async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script class=next-config data-name=enableMath type=application/json>true</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/third-party/math/mathjax.min.js></script><script class=next-config data-name=waline type=application/json>{"lang":"zh-CN","enable":true,"serverURL":"https://waline.longluo.me/","cssUrl":"https://unpkg.com/@waline/client@2.15.8/dist/waline.css","commentCount":true,"pageview":true,"libUrl":"https://unpkg.com/@waline/client@2.15.8/dist/waline.js","locale":{"placeholder":"欢迎大家的留言和评论！(评论只需要填昵称即可。) Welcome to comment"},"emoji":["https://unpkg.com/@waline/emojis@1.0.1/qq"],"meta":["nick","mail","link"],"requiredMeta":[["nick"]],"wordLimit":0,"pageSize":10,"el":"#waline","comment":true,"path":"/page/51/"}</script><link href=https://unpkg.com/@waline/client@2.15.8/dist/waline.css rel=stylesheet><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});</script>